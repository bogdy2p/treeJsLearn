<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - InnoKin Sketch</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                color: #cccccc;
                font-family:Monospace;
                font-size:13px;
                text-align:center;
                background-color: #000000;
                margin: 0px;
                overflow: hidden;
            }

            #info {
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
            }

            #remoteDiv{
                position:absolute;
                bottom:30px;
                height:40%;
                width:10%;
                text-align:center;
                background-color:yellow;
                display:none;

            }
            #selectDiv{
                position:absolute;
                top:20px;

            }

            .stateButtons{
                margin:0px auto;
                margin-top: 3px;
                text-align:center;
            }

            a {
                color: #0080ff;
            }

            #leftcontrols {
                position: absolute;
                bottom: 0px; width: 100%;
                height: 30px;
                padding: 5px;
                background-color: #FF66FF;
            }
            #container{
                position: absolute; left:0px; top:0px;
            }
            #hidden{
                z-index: 500;
                visibility: hidden;
                display:none;
            }


            @font-face {
                font-family: "DisrupterLCDFont";
                src: url("chesstype.ttf") format("truetype");
                font-weight: normal;
                font-style: normal;
            }

        </style>
    </head>
    <body>

        <div id="container"></div>
        <div id="info">
            <div id="hidden">
                <img id="logoImage" src="LogoInokin.png">
            </div>
            <a href="http://threejs.org" target="_blank">three.js</a> webgl - Innoking sketch  - by <a href="https://twitter.com/fernandojsg">ThePBC</a>
        </div>
        <div id="remoteDiv">
            <button class="stateButtons" id="state1Button" onclick="changeState(1);">state1Button</button>
            <button class="stateButtons" id="state2Button" onclick="changeState(2);">state2Button</button>
            <button class="stateButtons" id="state3Button" onclick="changeState(3);">state3Button</button>

        </div>
        <div id="selectDiv">

        </div>
        <div id ="leftcontrols">



            <!--            <button id="btn1" onclick="switchBattery({color: 0xFF6677, shininess: 30, specular: 0x990000, metal: true, side: THREE.DoubleSide});">Switch Battery</button>-->

            <button id="firstBtn" onclick="load8times();">load8times</button>
            <button id="btn4" onclick="displayDisruptorColourOptions();">Display Disruptor Colors</button>
            <button id="btn5" onclick="displayBatteryColourOptions();">BatteryColors</button>
            <button id="btn6" onclick="test();">test</button>



            <script>

                var pbc_debug = true;
                var toMoveObject = 'roata';
                var scale_to_move = 0.5;</script>


            <script>
                if (pbc_debug) {
                    function updateToMoveObject() {
                        toMoveObject = selectList.value;
                    }
                    function updateScaleToMoveObject() {
                        scale_to_move = scalesList.value;
                    }
                    var myDiv = document.getElementById("selectDiv");
                    var all_objects = [
                        'buton_interior_mecanism_tigara',
                        'buton_mare',
                        'buton_mic_1',
                        'buton_mic_2',
                        'capac_mecanism_tigara',
                        'ecran',
                        'ecran_behind',
                        'ecran_rama',
                        'filet_buton',
                        'filet_capac_mecanism_tigara',
                        'fund_mecanism_tigara',
                        'partea_inferioara_stecher',
                        'partea_superioara_stecher',
                        'shell_mecanism_tigara',
                        'suruburi_capac_mecanism_tigara',
                        'suruburi_fund_mecanism_tigara',
                        'text_mecanism_interior',
                        'sipca',
                        'sticla',
                        'logo_sipca',
                        'baterie',
                        'baterie_2',
                        'capac_baterie',
                        'fund_baterie',
                        'invelis_baterie',
                        'logo_textura_baterie',
                        'suruburi_baterie',
                        'suruburi_capac_baterie',
                        'suruburi_fund_baterie',
                        'text_baterie_bottom',
                        'battery_usb'];
                    var test_objects = [
                        'testCylinder1',
                        'testCylinder2',
                        'testCylinder3',
                        'testCylinder4',
                        'testCylinder5',
                        'testCylinder6',
                        'testbaterie0',
                        'testbaterie1',
                        'testbaterie2',
                        'testbaterie3',
                        'testbaterie4',
                        'testbaterie5',
                        'testbaterie6',
                        'testbaterie7',
                    ];
                    for (i = 0; i < test_objects.length; i++) {
                        all_objects.push(test_objects[i]);
                    }






                    var scales = [
                        0.1, 0.2, 0.5, 1, 2, 3, 5, 10, 30, 50
                    ];
                    var selectList = document.createElement("select");
                    selectList.id = "mySelect";
                    selectList.setAttribute("onchange", "updateToMoveObject()");
                    var scalesList = document.createElement("select");
                    scalesList.id = "scaleSelect";
                    scalesList.setAttribute("onchange", "updateScaleToMoveObject()");
                    console.log(selectList);
                    myDiv.appendChild(selectList);
                    myDiv.appendChild(scalesList);
                    for (var i = 0; i < all_objects.length; i++) {
                        var option = document.createElement("option");
                        option.value = all_objects[i];
                        option.text = all_objects [i];
                        selectList.appendChild(option);
                    }

                    for (var i = 0; i < scales.length; i++) {
                        var option = document.createElement("option");
                        option.value = scales[i];
                        option.text = scales[i];
                        scalesList.appendChild(option);
                    }
                }
            </script>

            <button id="btn6" onclick="innokinSplitInThree();">SPLIT / UNSPLIT</button>
            <button id="btn6" onclick="moveXplus(toMoveObject);">X + </button>
            <button id="btn6" onclick="moveXminus(toMoveObject);">X -</button>
            <button id="btn6" onclick="moveYplus(toMoveObject);">Y + </button>
            <button id="btn6" onclick="moveYminus(toMoveObject);">Y -</button>
            <button id="btn6" onclick="moveZplus(toMoveObject);">Z + </button>
            <button id="btn6" onclick="moveZminus(toMoveObject);">Z-</button>


        </div>

        <script src="js/three.min.js"></script>
        <script src="js/threex.dynamictexture.js"></script>
        <script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/libs/stats.min.js"></script>
        <script src ="js/ColladaLoader.js"></script>
        <script src ="js/OBJLoader.js"></script>
        <script src="js/Tween.js"></script>
        <script src="dat-gui/build/DAT.GUI.js"></script>


        <script src="js/ShaderParticles.min.js"></script>
        <script src="js/ShaderParticleGroup.js"></script>
        <script src="js/ShaderParticleEmitter.js"></script>

        <script>



                var object_is_not_split = true;
                var objects_finished_loading = false;
                var innokin_centered_to_screen = false;
                var OBJ_count = 0;
                var OBJ_number = 32;
                var device_status = "OFF";
                var device_state = 'watt';
                var startButtonTime = null;
                var startClick1 = null;
                var startClick2 = null;
                var startClick3 = null;
                var timer_running = false;
                var disruptor_started = false;
                var startButtonPushStart = null;
                var startButtonPushed = false;
                var device_variables = {
                    ohmz: 0.48,
                    volt: 7.5,
                    watt: 30.0,
                    battery: 100,
                }

                var ohmLetter = String.fromCharCode(0x2126);
                var group, grupMecanism, grupFiltru, grupBaterie, grupRoata, group2, group3, batteryChoicesGroup;
                var disruptor;
                var battery;
                var tigara;
                var container, mapCanvas;
                var controls, controls2;
                var camera, mapCamera, scene, renderer, raycaster, raycasterMap;
                var positions, colors;
                var mouseX = 0, mouseY = 0;
                var mouseXOnMouseDown = 0;
                var SCREEN_WIDTH, SCREEN_HEIGHT;
                var targetRotation = 0;
                var startButton, minusButtonCylinder, plusButtonCylinder, filtruTigara, chargerCube, disrupterCube;
                var targetRotationOnMouseDown = 0;
                var windowHalfX = window.innerWidth / 2;
                var windowHalfY = window.innerHeight / 2;
                var pointLight;
                var startButtonCounter = 0;
                var startButtonCounter2 = 0;
                var chargerMaterial;
                var tweenBatteryOut, tweenBatteryIn, tweenBatteryUp, tweenBatteryDown;
                var startTime = Date.now();
                var emitter, particleGroup;
                var disruptor_colours_shown = false;
                var battery_colours_shown = false;
//             
                var disruptorMaterials = {
                    silver_material: {color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide},
                    black_material: {color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide},
                    golden_material: {color: 0xEAE0D7, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide},
                };
                var batteryMaterials = {
                    black_battery: {color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide},
                    blue_battery: {color: 0x009EFA, shininess: 50, specular: 0x005ECA, metal: true, side: THREE.DoubleSide},
                    pink_battery: {color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide},
                    red_battery: {color: 0xFF6677, shininess: 30, specular: 0x990000, metal: true, side: THREE.DoubleSide},
                    green_battery: {color: 0x00FF00, shininess: 50, specular: 0x00FF00, metal: true, side: THREE.DoubleSide},
                    purple_battery: {color: 0xFF00FF, shininess: 50, specular: 0xFF00FF, metal: true, side: THREE.DoubleSide},
                    whiteblue_battery: {color: 0x009EFA, shininess: 50, specular: 0x00FFFF, metal: true, side: THREE.DoubleSide},
                };
                var optionsMaterials = {
                    //SPECULAR
                    black: {color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide},
                    blue: {color: 0x009EFA, shininess: 50, specular: 0x005ECA, metal: true, side: THREE.DoubleSide},
                    pink: {color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide},
                    red: {color: 0xFF6677, shininess: 30, specular: 0x990000, metal: true, side: THREE.DoubleSide},
                    green: {color: 0x00FF00, shininess: 50, specular: 0x00FF00, metal: true, side: THREE.DoubleSide},
                    purple: {color: 0xFF00FF, shininess: 50, specular: 0xFF00FF, metal: true, side: THREE.DoubleSide},
                    whiteblue: {color: 0x009EFA, shininess: 50, specular: 0x00FFFF, metal: true, side: THREE.DoubleSide},
                };
                var defaultMaterials = {
                    defaultBatterySupport: batteryMaterials.blue_battery,
                    defaultBatteryInside: batteryMaterials.black_battery,
                    defaultMechanism: disruptorMaterials.silver_material,
                    defaultFilter: {color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide},
                    defaultFilterGlass: {color: 0xFFFFFF, shininess: 10, specular: 0xDDDDDD, transparent: true, opacity: 0.3, side: THREE.DoubleSide},
                    topAndBottom: {color: 0xCCCCCC, shininess: 50, specular: 0xBBBBBB, metal: true, side: THREE.DoubleSide},
                    defaultScrews: {color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide},
                    defaultLogos: {color: 0xEAE0D7, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide},
                    defaultConnectorMaterial: {color: 0x9F8F53, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide},
                    defaultScreenTransparent: {color: 0x009900, shininess: 10, specular: 0xFF00FF, transparent: true, opacity: 0.3, side: THREE.DoubleSide},
//                    defaultScreenFrame: {color: 0x55500F, shininess: 50, specular: 0x33B0F0, metal: true, side: THREE.DoubleSide},
                    defaultScreenBackground: {color: 0x33300F, shininess: 50, specular: 0x22A0C0, metal: true, side: THREE.DoubleSide},
                }
                var userOpts = {
                    liftoff: 16,
                    range: 2000,
                    duration: 1500,
                    delay: 0,
                    easing: 'Exponential.EaseIn',
                    quintic_in: 'Quintic.EaseOut',
                }


                document.addEventListener('mousemove', onDocumentMouseMove, false);
                var manager = new THREE.LoadingManager();
                var objLoader = new THREE.OBJLoader(manager);
                init();
                animate();
                function init() {
                    container = document.getElementById('container');
                    scene = new THREE.Scene();
                    raycaster = new THREE.Raycaster();
                    clock = new THREE.Clock();
                    SCREEN_WIDTH = window.innerWidth;
                    SCREEN_HEIGHT = window.innerHeight;
                    var ASPECT_RATIO = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera = new THREE.PerspectiveCamera(50, ASPECT_RATIO, 1, 600);
                    if (pbc_debug) {
                        camera = new THREE.PerspectiveCamera(50, ASPECT_RATIO, 1, 10000);
                    }
                    //Normal (below)
                    camera.position.x = -120;
                    camera.position.z = 100;
                    camera.position.y = -80;
                    //Over-item
                    camera.position.x = -140;
                    camera.position.y = 70;
                    camera.position.z = 85;

                    if (pbc_debug) {
                        camera.position.x = 0;
                        camera.position.y = 80;
                        camera.position.z = 155;
//                        camera.translateY(350);

                    }
                    camera.rotateOnAxis(300);
//                    camera.position.x = 0;
//                    camera.position.z = 500;
//                    camera.position.y = 0;
                    scene.add(camera);
                    controls = new THREE.OrbitControls(camera, container);
                    controls.noZoom = false;
                    controls.minDistance = 80;
                    controls.maxDistance = 180;
                    controls.noPan = true;
                    if (pbc_debug) {
                        controls.minDistance = 2;
                        controls.maxDistance = 250;
                        controls.noPan = false;
                    }


                    controls.minPolarAngle = 0.8;
                    controls.maxPolarAngle = 1.6;
                    if (pbc_debug) {
                        controls.minPolarAngle = 0;
                        controls.maxPolarAngle = 2 * Math.PI;
                    }

                    var directionalLightStrength = 0.15;
                    var increase = 1;
                    var luminaDirectionala1 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala1.position.set(300 * increase, 300 * increase, 0 * increase);
                    luminaDirectionala1.name = "luminaDirectionala1";
                    scene.add(luminaDirectionala1);
                    var luminaDirectionala2 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala2.position.set(0 * increase, 300 * increase, 300 * increase);
                    luminaDirectionala2.name = "luminaDirectionala2";
                    scene.add(luminaDirectionala2);
                    var luminaDirectionala3 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala3.position.set(0 * increase, -300 * increase, 300 * increase);
                    luminaDirectionala3.name = "luminaDirectionala3";
                    scene.add(luminaDirectionala3);
                    var luminaDirectionala4 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala4.position.set(-300 * increase, 300 * increase, 0 * increase);
                    luminaDirectionala4.name = "luminaDirectionala4";
                    scene.add(luminaDirectionala4);
                    var luminaDirectionala5 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala5.position.set(0 * increase, -300 * increase, 300 * increase);
                    luminaDirectionala5.name = "luminaDirectionala5";
                    scene.add(luminaDirectionala5);
                    var luminaDirectionala6 = new THREE.DirectionalLight(0xffffff, directionalLightStrength);
                    luminaDirectionala6.position.set(0 * increase, -300 * increase, -300 * increase);
                    luminaDirectionala6.name = "luminaDirectionala6";
                    scene.add(luminaDirectionala6);
                    if (pbc_debug) {
                        var testHelper = new THREE.AxisHelper(50);
                        scene.add(testHelper);
                        var testBoxGeom = new THREE.BoxGeometry(30, 30, 30, 30);
                        var testBoxMat = new THREE.MeshBasicMaterial();
                        var testBox = new THREE.Mesh(testBoxGeom, testBoxMat);
                        var testBox2 = new THREE.Mesh(testBoxGeom, testBoxMat);
                        var testBox3 = new THREE.Mesh(testBoxGeom, testBoxMat);
                        var testBox4 = new THREE.Mesh(testBoxGeom, testBoxMat);
                        var testBox5 = new THREE.Mesh(testBoxGeom, testBoxMat);
                        var testBox6 = new THREE.Mesh(testBoxGeom, testBoxMat);
                        scene.add(testBox);
                        scene.add(testBox2);
                        scene.add(testBox3);
                        scene.add(testBox4);
                        scene.add(testBox5);
                        scene.add(testBox6);
                        testBox.position.copy(luminaDirectionala1.position);
                        testBox2.position.copy(luminaDirectionala2.position);
                        testBox3.position.copy(luminaDirectionala3.position);
                        testBox4.position.copy(luminaDirectionala4.position);
                        testBox5.position.copy(luminaDirectionala5.position);
                        testBox6.position.copy(luminaDirectionala6.position);
                        var SphereSize = 100;
                        var LightHelper1 = new THREE.DirectionalLightHelper(luminaDirectionala1, SphereSize);
                        scene.add(LightHelper1);
                        var LightHelper2 = new THREE.DirectionalLightHelper(luminaDirectionala2, SphereSize);
                        scene.add(LightHelper2);
                        var LightHelper3 = new THREE.DirectionalLightHelper(luminaDirectionala3, SphereSize);
                        scene.add(LightHelper3);
                        var LightHelper4 = new THREE.DirectionalLightHelper(luminaDirectionala4, SphereSize);
                        scene.add(LightHelper4);
                        var LightHelper5 = new THREE.DirectionalLightHelper(luminaDirectionala5, SphereSize);
                        scene.add(LightHelper5);
                        var LightHelper6 = new THREE.DirectionalLightHelper(luminaDirectionala6, SphereSize);
                        scene.add(LightHelper6);
                    }

                    pointLight = new THREE.PointLight(0xcccccc, 0.3);
                    pointLight.position.set(20, 20, 20);
                    scene.add(pointLight);
                    group = new THREE.Group();
                    scene.add(group);
                    grupMecanism = new THREE.Group();
                    grupMecanism.name = "grupPrincipal";
                    scene.add(grupMecanism);
                    grupFiltru = new THREE.Group();
                    grupFiltru.name = "grupFiltru";
                    scene.add(grupFiltru);
                    grupBaterie = new THREE.Group();
                    grupBaterie.name = "grupBaterie";
                    scene.add(grupBaterie);
                    grupRoata = new THREE.Group();
                    grupRoata.name = "grupRoata";
                    scene.add(grupRoata);
//                    grupRoata.position.x = 0;
//                    grupRoata.position.z = 0.5;
                    //load the 3d Model files
                    //////////////////////////////////////////////

                    load3DOBJmodels();
                    //////////////////////////////////////////////
                    // Add Charger 

                    renderer = new THREE.WebGLRenderer({antialias: true});
                    renderer.setClearColor(0x559955, 1);
                    renderer.setPixelRatio(window.devicePixelRatio);
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.gammaInput = true;
                    renderer.gammaOutput = true;
                    container.appendChild(renderer.domElement);
                    renderer.domElement.addEventListener('mousedown', onDocumentMouseDown, false);
                    renderer.domElement.addEventListener('touchstart', onDocumentTouchStart, false);
                    renderer.domElement.addEventListener('touchmove', onDocumentTouchMove, false);
                    window.addEventListener('resize', onWindowResize, false);
//                    renderer.autoClear = false;
                    test();

//                    addScreens('ana are mere');
                }

                function initParticles() {
                    particleGroup = new SPE.Group({
                        texture: THREE.ImageUtils.loadTexture('images/smokeparticle.png'),
                        maxAge: 5,
                        hasPerspective: true,
                        colorize: true
                    });
                    emitter = new SPE.Emitter({
                        position: new THREE.Vector3(-11.5, 45, -2),
                        positionSpread: new THREE.Vector3(0, 0, 0),
                        acceleration: new THREE.Vector3(0, 30, 00),
                        accelerationSpread: new THREE.Vector3(0, 5, 0),
                        velocity: new THREE.Vector3(0, 0, 0),
                        velocitySpread: new THREE.Vector3(10, 10, 10),
//                        velocitySpread: new THREE.Vector3(0, 0, 0),
                        colorStart: new THREE.Color(0x111111),
                        colorEnd: new THREE.Color(0x000000),
                        sizeStart: 15,
                        sizeEnd: 500,
                        particleCount: 100,
                    });
                    particleGroup.addEmitter(emitter);
                    scene.add(particleGroup.mesh);
                }



                function onWindowResize() {

                    windowHalfX = window.innerWidth / 2;
                    windowHalfY = window.innerHeight / 2;
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }

                function animate() {

                    requestAnimationFrame(animate);
                    render(clock.getDelta());
                    TWEEN.update();
                }

                function restartEngine(parameters)
                {

                    engine.destroy();
                    engine = new ParticleEngine();
                    engine.setValues(parameters);
                    engine.initialize();
                }


                function onDocumentMouseDown(event) {
                    event.preventDefault();
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                    var mouseVector = new THREE.Vector3();
                    mouseVector.x = 2 * (event.clientX / SCREEN_WIDTH) - 1;
                    mouseVector.y = 1 - 2 * (event.clientY / SCREEN_HEIGHT);
                    raycaster.setFromCamera(mouseVector, camera);
                    var intersectedObjects = raycaster.intersectObjects(scene.children, true);
                    if (intersectedObjects.length > 0) {

                        var Object = intersectedObjects[0];
                        console.log(Object);
                        console.log(Object.object.name);
                        switch (Object.object.parent.name) {

                            case 'sevenColourBoxes':


                                temp_material = Object.object.material.color;
                                temp_color = Object.object.material.color.getHex();
                                temp_specular = Object.object.material.specular.getHex();
                                console.log(temp_material);
                                switchBattery({color: temp_color, shininess: 30, specular: temp_specular, metal: true, side: THREE.DoubleSide});
                                removeBatteryColourOptions();
                                break;
                            case 'threeColourBoxes':

                                mechanism_temp_material = Object.object.material;
                                var mechanism = scene.getObjectByName('shell_mecanism_tigara');
                                mechanism.children[0].material = mechanism_temp_material;
                                removeDisruptorColourOptions();
                                break;
                            case 9:
                                console.log("You clicked the disruptor");
                                break;
                            case 'buton_mare':
                                console.log("You clicked START");
                                startButtonClick();
                                break;
                            case 'optionsGroup':

                                optionsGroup = scene.getObjectByName("optionsGroup");
                                console.log(optionsGroup);
                                console.log(scene);
                                console.log(window.SCREEN_WIDTH);
                                console.log(window.SCREEN_HEIGHT);
//                                startButtonCounter += 1;
//                                playButonMareAction();
                                break;
                            case 'buton_mic_1':
                                console.log("You pressed the +");
                                plusButtonClick();
//                                restartEngine(Examples.smoke);
                                break;
                            case 'buton_mic_2':
                                console.log("You pressed the -");
                                minusButtonClick();
                                break;
                            case 13:
                                console.log("Why did you click the screen ?");
                                break;
                            case 14:
                                console.log("Why click the Filter ?");
                                break;
                            default:
//                                console.log(Object.object.name);
//                                console.log("UNKNOWN CLICK. ID OR NAME NOT RECOGNIZED");
//                                console.log(Object);
                                break;
                        }

                    }

                }

                function onDocumentMouseMove(event) {
                    if (OBJ_count === OBJ_number) {
//                        console.log("OBJECT COUNT IS NUMBER");
                        if (!innokin_centered_to_screen) {
                            objects_finished_loading = true;
                            basicColorizeOBJ();
                            console.clear();
                            load8times();
                            console.log("Cleared OnDocumentMouseMove");
                            innokin_centered_to_screen = true;
                            OBJ_count += 1;
                        }
                    }

                    mouseX = event.clientX - windowHalfX;
                    targetRotationX = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.002;
                }

                function onDocumentMouseUp(event) {
//                    console.log(event);
                    renderer.domElement.addEventListener(
                            'mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                    resetButtonPositions();
//                    if (!disruptor_started) {
//                        if (startButtonPushed) {
//                            var newTime = clock.elapsedTime;
//                            var timeDifference = newTime - startButtonPushStart;
//                            startButtonPushed = false;
////                            alert(timeDifference);
//                            if (timeDifference > 1) {
//                                startDisruptorWithLogo('ASD');
//                            }
//                        }
//                    } else {
//                        console.log("disruptor already  ON");
//                    }
                }

                function onDocumentMouseOut(event) {
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                }

                function onDocumentTouchStart(event) {
//                    alert("TOUCH DETECTED");
//                    alert(event);
                }

                function onDocumentTouchMove(event) {
//                    alert("TOUCH MOVEMENT DETECTED");
                }

                function startButtonClick() {
                    var startButton = scene.getObjectByName('buton_mare');
                    var twoClicksDifference = 0;
                    var threeClicksDifference = 0;
                    startButton.position.x += 0.3;
                    startButtonCounter += 1;
                    startButtonCounter2 += 1;
                    if (device_status === "OFF") {

                        startButtonPushStart = clock.elapsedTime;
                        startButtonPushed = true;
                        if (startButtonCounter % 3 == 1) {
                            clearTimeout();
                            startClick1 = clock.elapsedTime;
                            timer_running = true;
                            setTimeout(function () {
                                if (timer_running) {


                                    displayStartInformation();
//                                    console.log('SOMETHING WENT WRONG');
//                                    console.log("the 400 ms timeout has been exceeded or too many clicks");
                                } else {
                                    if (startButtonCounter2 > 0)
                                        if ((startButtonCounter2 % 3) == 0)
                                        {
//                                            console.log("I THINK WE SHOULD START THE LIGHTER (LOGO)");
//                                            console.log(startButtonCounter2);
                                        }

                                }
                            }, 400);
                        }
                        if (startButtonCounter % 3 == 2) {
                            clearTimeout();
                            startClick2 = clock.elapsedTime;
                            twoClicksDifference = startClick2 - startClick1;
                            timer_running = false;
//                            console.log("2Clizks");
//                            console.log(twoClicksDifference);

                        }
                        if (startButtonCounter % 3 == 0) {
                            clearTimeout();
                            startClick3 = clock.elapsedTime;
                            threeClicksDifference = startClick3 - startClick1;
                            timer_running = false;
//                            startButtonCounter = 0;
//                            console.log("3Clizks");
//                            console.log(threeClicksDifference);

                            startDisruptorWithLogo();
                            device_status = "ON";
                        }


                        console.log("ClickNUMBER");
                        console.log(startButtonCounter);
//                        

                    }
                    setTimeout(function () {
                        timer_running = true;
                        startButtonCounter = 0;
                    }, 600);
                    if (device_status === "ON") {

//                        alert('THE DEVICE IS ONLINE');

                    }









//                    console.log("STARTBUTTON CLICKED");

//                    console.log(clock);
//                    console.log(clock);
//                    if (startButtonCounter % 3 == 1) {
//                        startClick1 = clock.elapsedTime;
//                    } else if (startButtonCounter % 3 == 2) {
//                        startClick2 = clock.elapsedTime;
//                    } else {
//                        startClick3 = clock.elapsedTime;
//
//
//                        var difference = startClick3 - startClick1;
//
//                        console.log('Click1');
//                        console.log(startClick1);
//                        console.log('Click2');
//                        console.log(startClick2);
//                        console.log('Click3');
//                        console.log(startClick3);
//                        console.log("Difference:");
//                        console.log(difference);
//                    }
//





//                    startButtonTime = clock.oldTime;
//                    console.log(startButtonTime);









//                    playButonMareAction();









                }

                function plusButtonClick() {
                    console.log("Plusbuttonclick LOGGED");
                    var buttonSmall1 = scene.getObjectByName('buton_mic_1');
                    buttonSmall1.position.x += 0.3;
                    console.log(device_status);
                    if (device_status === "ON") {
                        console.log(device_state);
                        console.log(device_variables);
                        switch (device_state) {

                            case 'ohmz':
                                console.log('ohmz');
                                device_variables.ohmz += 0.01;
                                refreshDisruptorInformations();
                                break;
                            case 'volt':
                                console.log('volt');
                                device_variables.volt += 0.1;
                                refreshDisruptorInformations();
                                break;
                            case 'watt':
                                console.log('watt');
                                if (device_variables.watt < 49.6) {
                                    device_variables.watt += 0.5;
                                } else {
                                    device_variables.watt = 6.0;
                                }
                                refreshDisruptorInformations();
                                break;
                        }
                    }





                }

                function minusButtonClick() {
                    console.log("Minusbutton click LOGGED");
                    var buttonSmall2 = scene.getObjectByName('buton_mic_2');
                    buttonSmall2.position.x += 0.3;
                    console.log(device_status);
                    if (device_status === "ON") {
                        console.log(device_state);
                        console.log(device_variables);
                        switch (device_state) {

                            case 'ohmz':
                                console.log('ohmz');
                                device_variables.ohmz -= 0.01;
                                refreshDisruptorInformations();
                                break;
                            case 'volt':
                                console.log('volt');
                                device_variables.volt -= 0.1;
                                refreshDisruptorInformations();
                                break;
                            case 'watt':
                                console.log('watt');
                                if (device_variables.watt > 6.4) {
                                    device_variables.watt -= 0.5;
                                } else {
                                    device_variables.watt = 50.0;
                                }
                                refreshDisruptorInformations();
                                break;
                        }
                    }



                }

                function resetButtonPositions() {
                    var startButton = scene.getObjectByName('buton_mare');
                    var buttonSmall1 = scene.getObjectByName('buton_mic_1');
                    var buttonSmall2 = scene.getObjectByName('buton_mic_2');
                    startButton.position.x = 0;
                    buttonSmall1.position.x = 0;
                    buttonSmall2.position.x = 0;
                }

                function render(dt) {
                    if (particleGroup) {
                        particleGroup.tick(dt);
                    }
                    batteryChoicesGroup = scene.getObjectByName("batteryChoicesGroup");
                    if (batteryChoicesGroup) {
//                        console.log(batteryChoicesGroup.children.length);

//                         batteryChoicesGroup.children[0].position.x += 0.01;

//                          batteryChoicesGroup.children[0].position.copy(camera.position);
//                          batteryChoicesGroup.children[0].rotation.copy(camera.rotation);


                    }
                    var rotationSpeed = 10;
                    threeBoxesGroup = scene.getObjectByName("threeColourBoxes");
                    if (threeBoxesGroup) {
                        goldenBox = threeBoxesGroup.children[0];
                        silverBox = threeBoxesGroup.children[1];
                        blackBox = threeBoxesGroup.children[2];
                        goldenBox.position.copy(camera.position);
                        goldenBox.rotation.copy(camera.rotation);
                        goldenBox.updateMatrix();
                        goldenBox.translateZ(-300);
                        goldenBox.translateX(40);
                        goldenBox.translateY(100);
                        silverBox.position.copy(camera.position);
                        silverBox.rotation.copy(camera.rotation);
                        silverBox.updateMatrix();
                        silverBox.translateZ(-300);
                        silverBox.translateX(-40);
                        silverBox.translateY(100);
                        blackBox.position.copy(camera.position);
                        blackBox.rotation.copy(camera.rotation);
                        blackBox.updateMatrix();
                        blackBox.translateZ(-300);
                        blackBox.translateX(-00);
                        blackBox.translateY(100);
                    }
                    sevenBoxesGroup = scene.getObjectByName("sevenColourBoxes");
                    if (sevenBoxesGroup) {
                        var boxes = [];
                        for (i = 0; i < 7; i++) {
                            boxes[i] = sevenBoxesGroup.children[i];
                            boxes[i].position.copy(camera.position);
                            boxes[i].rotation.copy(camera.rotation);
                            boxes[i].translateZ(-300);
                            boxes[i].translateY(100);
                            boxes[i].translateX(-110 + 40 * i);
                        }
                    }
                    optionsGroup = scene.getObjectByName("optionsGroup");
                    if (optionsGroup) {


//                        console.log(optionsGroup);


                        optionBox1 = optionsGroup.children[0];
//                        optionBox2 = optionsGroup.children[1];
//                        optionBox3 = optionsGroup.children[2];
                        optionBox1.position.copy(camera.position);
                        optionBox1.rotation.copy(camera.rotation);
//                        optionBox2.position.copy(camera.position);
//                        optionBox2.rotation.copy(camera.rotation);
//                        optionBox3.position.copy(camera.position);
//                        optionBox3.rotation.copy(camera.rotation);

                        optionBox1.translateZ(-250); // BIGGER IS MORE TO THE CAMERA
                        optionBox1.translateY(-30); // top bottom  (bottom is about 80)
                        optionBox1.translateX(window.SCREEN_WIDTH / 2 - 800); // 0 - middle , + = to right , - = to left
//                        optionBox2.translateZ(-250); // BIGGER IS MORE TO THE CAMERA
//                        optionBox2.translateY(-55); // top bottom  (bottom is about 80)
//                        optionBox2.translateX(-120); // 0 - middle , + = to right , - = to left
//                        optionBox3.translateZ(-250); // BIGGER IS MORE TO THE CAMERA
//                        optionBox3.translateY(-80); // top bottom  (bottom is about 80)
//                        optionBox3.translateX(-120); // 0 - middle , + = to right , - = to left

                        optionBox1.updateMatrix();
//                        optionBox2.updateMatrix();
//                        optionBox3.updateMatrix();

                    }

                    largeScreenShown = scene.getObjectByName('largeScreen');
                    if (largeScreenShown) {
                        largeScreenShown.position.copy(camera.position);
                        largeScreenShown.rotation.copy(camera.rotation);
                        largeScreenShown.translateZ(-150);
                        largeScreenShown.updateMatrix();
                        largeScreenShown.translateY(-40);
                        largeScreenShown.translateX(80);
                    }




                    var newlightposition = camera.position;
                    pointLight.position.set(camera.position.x, camera.position.y, camera.position.z);
                    var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
                    camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera.updateProjectionMatrix();
                    // setViewport parameters:
                    //  lower_left_x, lower_left_y, viewport_width, viewport_height

                    renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
                    renderer.clear();
                    // left side
                    renderer.setViewport(1, 1, SCREEN_WIDTH - 2, SCREEN_HEIGHT - 2);
                    renderer.render(scene, camera);
                }


                function switchBattery(materialColor) {
//                    console.log(batterySupport.position);
                    setupTweenBatteryOut();
                    setupTweenBatteryIn();
                    tweenBatteryUp.start();
                    setTimeout(function () {
                        colorizeBattery(materialColor);
                    }, 2400);
                    setTimeout(function () {
                        tweenBatteryOut.stop();
                        tweenBatteryIn.start();
                    }, 3000);
                    setTimeout(function () {
                        tweenBatteryIn.stop();
                    }, 4700);
                    setTimeout(function () {
//                        alert("Click sound");
                    }, 5200);
                }

                function removeFilter() {

                    setupTweenFilterRotate();
                    setupTweenFilterGoUp();
                    setupTweenFilterGoOut();
                }


                function disrupter() {
                    console.log(scene);
                    var grupbaterie = scene.getObjectByName("grupBaterie");
                    grupbaterie.position.z += 5;
                }


                function startDisruptorWithLogo() {
                    var small_screen_already_exists = scene.getObjectByName('smallScreen');
                    if (!small_screen_already_exists) {
                        //ONLY ADD THE SCREENS IF THEY ARE NOT ALREADY PRESENT !!!



                        var screenDynamicTexture = new THREEx.DynamicTexture(400, 200);
                        screenDynamicTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                        var planeGeometry1 = new THREE.PlaneBufferGeometry(45, 20, 30, 30);
                        var planeGeometry2 = new THREE.PlaneBufferGeometry(112, 50, 30, 30);
                        var planeMaterial = new THREE.MeshBasicMaterial({
                            map: screenDynamicTexture.texture
                        });
                        var ScreenPlane = new THREE.Mesh(planeGeometry1, planeMaterial);
                        ScreenPlane.name = 'smallScreen';
                        var LargeScreen = new THREE.Mesh(planeGeometry2, planeMaterial);
                        LargeScreen.name = 'largeScreen';
                        grupMecanism.add(ScreenPlane);
                        ScreenPlane.position.x = -15.8; // DEPTH BIGGER IS INSIDE
                        ScreenPlane.position.z = -1.9; // LEFT RIGHT (smaller is LEFT
                        ScreenPlane.position.y = 13; // TOP BOTTOM
                        ScreenPlane.rotation.z = Math.PI / 2;
                        ScreenPlane.rotation.y = -Math.PI / 2;
                        screenDynamicTexture.texture.needsUpdate = true;
                        screenDynamicTexture.clear('#667788');
//                        var logoImage = "LogoInokin.png";
                        var logoImage = document.getElementById("logoImage");
                        screenDynamicTexture.drawImage(logoImage, 20, 50);
                        screenDynamicTexture.drawTextCooked(
                                {
//                                    margin: 0.3,
                                    align: 'center',
                                    text: '          INNOKIN',
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "bold " + (0.2 * 190) + "px Arial"
                                }
                        );
                        screenDynamicTexture.drawTextCooked(
                                {
//                                    margin: 0.15,
                                    text: '                                      TECHNOLOGY',
                                    align: 'center',
                                    lineHeight: 0.3,
                                    fillStyle: '#FDFDFD',
                                    font: "" + (0.2 * 190) + "px DisrupterLCDFont",
                                    family: "DisrupterLCDFont"
                                }
                        );
                        ScreenPlane.scale.x = 0.25;
                        ScreenPlane.scale.y = 0.25;
                        ScreenPlane.scale.z = 0.25;
                        LargeScreen.scale.x = 0.5;
                        LargeScreen.scale.y = 0.5;
                        LargeScreen.scale.z = 0.5;
                        scene.add(LargeScreen);
                        setTimeout(function () {
                            grupMecanism.remove(ScreenPlane);
                            scene.remove(LargeScreen);
                        }, 2000);
                        setTimeout(function () {
                            displayDisruptor();
                        }, 2100);
                    } else {
                        alert('Cannot add doubles @ this');
                    }
                }


                function displayStartInformation() {


                    var small_screen_already_exists = scene.getObjectByName('smallScreen');
                    if (!small_screen_already_exists) {
                        //ONLY ADD THE SCREENS IF THEY ARE NOT ALREADY PRESENT !!!



                        var screenDynamicTexture = new THREEx.DynamicTexture(400, 150);
                        screenDynamicTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                        var planeGeometry1 = new THREE.PlaneBufferGeometry(45, 20, 30, 30);
                        var planeGeometry2 = new THREE.PlaneBufferGeometry(112, 50, 30, 30);
                        var planeMaterial = new THREE.MeshBasicMaterial({
                            map: screenDynamicTexture.texture
                        });
                        var ScreenPlane = new THREE.Mesh(planeGeometry1, planeMaterial);
                        ScreenPlane.name = 'smallScreen';
                        var LargeScreen = new THREE.Mesh(planeGeometry2, planeMaterial);
                        LargeScreen.name = 'largeScreen';
                        grupMecanism.add(ScreenPlane);
                        ScreenPlane.position.x = -15.8; // DEPTH BIGGER IS INSIDE
                        ScreenPlane.position.z = -1.9; // LEFT RIGHT (smaller is LEFT
                        ScreenPlane.position.y = 13; // TOP BOTTOM
                        ScreenPlane.rotation.z = Math.PI / 2;
                        ScreenPlane.rotation.y = -Math.PI / 2;
                        screenDynamicTexture.texture.needsUpdate = true;
                        screenDynamicTexture.clear('#667788');
                        screenDynamicTexture.drawTextCooked(
                                {
                                    text: "        OFF",
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "bold " + (0.2 * 256) + "px Arial"
                                }
                        );
                        screenDynamicTexture.drawTextCooked(
                                {
                                    text: "                         Click 3x ON",
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "bold " + (0.2 * 256) + "px Arial"
                                });
                        ScreenPlane.scale.x = 0.25;
                        ScreenPlane.scale.y = 0.25;
                        ScreenPlane.scale.z = 0.25;
                        LargeScreen.scale.x = 0.5;
                        LargeScreen.scale.y = 0.5;
                        LargeScreen.scale.z = 0.5;
                        scene.add(LargeScreen);
                        setTimeout(function () {
                            grupMecanism.remove(ScreenPlane);
                            scene.remove(LargeScreen);
                        }, 1500);
                    } else {
                        alert('Cannot add doubles @ this');
                    }
                }


                function displayDisruptor() {


                    var small_screen_already_exists = scene.getObjectByName('smallScreen');
                    if (!small_screen_already_exists) {
                        //ONLY ADD THE SCREENS IF THEY ARE NOT ALREADY PRESENT !!!



                        var screenDynamicTexture = new THREEx.DynamicTexture(400, 200);
                        screenDynamicTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                        var planeGeometry1 = new THREE.PlaneBufferGeometry(45, 20, 30, 30);
                        var planeGeometry2 = new THREE.PlaneBufferGeometry(112, 50, 30, 30);
                        var planeMaterial = new THREE.MeshBasicMaterial({
                            map: screenDynamicTexture.texture
                        });
                        console.log(planeMaterial);
                        planeMaterial.name = 'textureMaterialScreen';
                        console.log(planeMaterial);
                        var ScreenPlane = new THREE.Mesh(planeGeometry1, planeMaterial);
                        ScreenPlane.name = 'smallScreen';
                        var LargeScreen = new THREE.Mesh(planeGeometry2, planeMaterial);
                        LargeScreen.name = 'largeScreen';
                        grupMecanism.add(ScreenPlane);
                        ScreenPlane.position.x = -15.8; // DEPTH BIGGER IS INSIDE
                        ScreenPlane.position.z = -1.9; // LEFT RIGHT (smaller is LEFT
                        ScreenPlane.position.y = 13; // TOP BOTTOM
                        ScreenPlane.rotation.z = Math.PI / 2;
                        ScreenPlane.rotation.y = -Math.PI / 2;
                        screenDynamicTexture.texture.needsUpdate = true;
                        screenDynamicTexture.clear('#667788');
                        //OHM INFORMATION
                        screenDynamicTexture.drawTextCooked(
                                {
                                    margin: 0.05,
                                    text: device_variables.ohmz + ohmLetter,
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "" + (0.20 * 256) + "px Arial"
                                }
                        );
                        //VOLTAGE INFORMATION
                        screenDynamicTexture.drawTextCooked(
                                {
                                    margin: 0.05,
                                    top: 0.5,
                                    text: '                          ' + device_variables.volt + 'V',
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "" + (0.20 * 256) + "px Arial"
                                }
                        );
                        //WATTAGE INFORMATION
                        screenDynamicTexture.drawTextCooked(
                                {
                                    text: '      ' + device_variables.watt + 'W',
                                    lineHeight: 0.5,
                                    fillStyle: '#FDFDFD',
                                    font: "" + (0.3 * 256) + "px Arial"
                                }
                        );
                        //BATTERY INFORMATION
                        screenDynamicTexture.drawTextCooked(
                                {
                                    text: '                                            B',
                                    lineHeight: 0.25,
                                    fillStyle: '#00FDFD',
                                    font: "bold " + (0.2 * 256) + "px Arial"
                                }
                        );
                        ScreenPlane.scale.x = 0.25;
                        ScreenPlane.scale.y = 0.25;
                        ScreenPlane.scale.z = 0.25;
                        LargeScreen.scale.x = 0.5;
                        LargeScreen.scale.y = 0.5;
                        LargeScreen.scale.z = 0.5;
                        scene.add(LargeScreen);
                        setRemoteVisible();
                    } else {
                        alert('Cannot add doubles @ this');
                    }
                }
                function refreshDisruptorInformations() {

                    var existingSmallScreen = scene.getObjectByName('smallScreen');
                    var existingLargeScreen = scene.getObjectByName('largeScreen');
                    var newScreenDynamicTexture = new THREEx.DynamicTexture(400, 200);
                    newScreenDynamicTexture.name = 'screenDynamicTexture';
                    newScreenDynamicTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                    newScreenDynamicTexture.texture.needsUpdate = true;
                    newScreenDynamicTexture.clear('#667788');
                    //OHM INFORMATION
                    newScreenDynamicTexture.drawTextCooked(
                            {
                                margin: 0.05,
                                text: device_variables.ohmz + ohmLetter,
                                lineHeight: 0.35,
                                fillStyle: '#FDFDFD',
                                font: "" + (0.20 * 256) + "px Arial"
                            }
                    );
                    //VOLTAGE INFORMATION
                    newScreenDynamicTexture.drawTextCooked(
                            {
                                margin: 0.05,
                                top: 0.5,
                                text: '                          ' + device_variables.volt + 'V',
                                lineHeight: 0.35,
                                fillStyle: '#FDFDFD',
                                font: "" + (0.20 * 256) + "px Arial"
                            }
                    );
                    //WATTAGE INFORMATION
                    newScreenDynamicTexture.drawTextCooked(
                            {
                                text: '      ' + device_variables.watt + 'W',
                                lineHeight: 0.5,
                                fillStyle: '#FDFDFD',
                                font: "" + (0.3 * 256) + "px Arial"
                            }
                    );
                    //BATTERY INFORMATION
                    newScreenDynamicTexture.drawTextCooked(
                            {
                                text: '                                            B',
                                lineHeight: 0.25,
                                fillStyle: '#00FDFD',
                                font: "bold " + (0.2 * 256) + "px Arial"
                            }
                    );
                    var newPlaneMaterial = new THREE.MeshBasicMaterial({
                        map: newScreenDynamicTexture.texture
                    });
                    existingSmallScreen.material = newPlaneMaterial;
                    existingLargeScreen.material = newPlaneMaterial;
                }

                function startTheDisruptor(text_to_display) {


                    var small_screen_already_exists = scene.getObjectByName('smallScreen');
                    if (!small_screen_already_exists) {
                        //ONLY ADD THE SCREENS IF THEY ARE NOT ALREADY PRESENT !!!



                        var screenDynamicTexture = new THREEx.DynamicTexture(400, 200);
                        screenDynamicTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                        var planeGeometry1 = new THREE.PlaneBufferGeometry(45, 20, 30, 30);
                        var planeGeometry2 = new THREE.PlaneBufferGeometry(112, 50, 30, 30);
                        var planeMaterial = new THREE.MeshBasicMaterial({
                            map: screenDynamicTexture.texture
                        });
                        var ScreenPlane = new THREE.Mesh(planeGeometry1, planeMaterial);
                        ScreenPlane.name = 'smallScreen';
                        var LargeScreen = new THREE.Mesh(planeGeometry2, planeMaterial);
                        LargeScreen.name = 'largeScreen';
                        grupMecanism.add(ScreenPlane);
                        ScreenPlane.position.x = -15.8; // DEPTH BIGGER IS INSIDE
                        ScreenPlane.position.z = -1.9; // LEFT RIGHT (smaller is LEFT
                        ScreenPlane.position.y = 13; // TOP BOTTOM
                        ScreenPlane.rotation.z = Math.PI / 2;
                        ScreenPlane.rotation.y = -Math.PI / 2;
                        screenDynamicTexture.texture.needsUpdate = true;
                        screenDynamicTexture.clear('#667788');
                        screenDynamicTexture.drawTextCooked(
                                {
                                    text: text_to_display,
                                    lineHeight: 0.3,
                                    fillStyle: '#FDFDFD',
                                    font: "bold " + (0.2 * 256) + "px Arial"
                                }
                        );
                        ScreenPlane.scale.x = 0.25;
                        ScreenPlane.scale.y = 0.25;
                        ScreenPlane.scale.z = 0.25;
                        LargeScreen.scale.x = 0.5;
                        LargeScreen.scale.y = 0.5;
                        LargeScreen.scale.z = 0.5;
                        scene.add(LargeScreen);
                    } else {
                        alert('Cannot add doubles @ this');
                    }
                }


                manager.onProgress = function (item, loaded, total) {
                    console.log(item, loaded, total);
                }


                var onProgress = function (xhr) {
                    console.log(object);
                    if (xhr.lengthComputable) {
                        var percentComplete = xhr.loaded / xhr.total * 100;
                        console.log(Math.round(percentComplete, 2) + '% downloaded');
                    }
                }


                var onLoad = function (xhr) {
//                    console.log("OnLOAD CALLED !");
                };
                var onError = function (xhr) {

                };
                var texture = new THREE.Texture();
                function load3DOBJmodels() {


                    var roata_only = [
                        'roata',
                    ]

                    var filtru_only = [
                        'sipca',
                        'sticla',
                        'logo_sipca',
                    ];
                    var mecanism_only = [
                        'buton_interior_mecanism_tigara',
                        'buton_mare',
                        'buton_mic_1',
                        'buton_mic_2',
                        'capac_mecanism_tigara',
                        'ecran',
                        'ecran_behind',
                        'ecran_rama',
                        'filet_buton',
                        'filet_capac_mecanism_tigara',
                        'fund_mecanism_tigara',
                        'partea_inferioara_stecher',
                        'partea_superioara_stecher',
                        'shell_mecanism_tigara',
                        'suruburi_capac_mecanism_tigara',
                        'suruburi_fund_mecanism_tigara',
                        'text_mecanism_interior',
                    ];
                    var baterie_only = [
                        'baterie',
                        'baterie_2',
                        'capac_baterie',
                        'fund_baterie',
                        'invelis_baterie',
                        'logo_textura_baterie',
                        'suruburi_baterie',
                        'suruburi_capac_baterie',
                        'suruburi_fund_baterie',
                        'text_baterie_bottom',
                        'battery_usb',
                    ];
                    var array_of_names = [
                        'sipca',
                        'sticla',
                        'baterie',
                        'baterie_2',
                        'battery_usb',
                        'buton_interior_mecanism_tigara',
                        'buton_mare',
                        'buton_mic_1',
                        'buton_mic_2',
                        'capac_baterie',
                        'capac_mecanism_tigara',
                        'ecran',
                        'ecran_behind',
                        'ecran_rama',
                        'filet_buton',
                        'filet_capac_mecanism_tigara',
                        'fund_baterie',
                        'fund_mecanism_tigara',
                        'invelis_baterie',
                        'logo_sipca',
                        'logo_textura_baterie',
                        'partea_inferioara_stecher',
                        'partea_superioara_stecher',
                        'shell_mecanism_tigara',
                        'suruburi_baterie',
                        'suruburi_capac_baterie',
                        'suruburi_capac_mecanism_tigara',
                        'suruburi_fund_baterie',
                        'suruburi_fund_mecanism_tigara',
                        'text_baterie_bottom',
                        'text_mecanism_interior',
                    ];
                    var testMaterial = new THREE.MeshPhongMaterial(batteryMaterials.pink_battery);
                    var testMaterial2 = new THREE.MeshPhongMaterial(batteryMaterials.red_battery);
                    var testMaterial3 = new THREE.MeshPhongMaterial(batteryMaterials.blue_battery);
                    var roataMaterial = new THREE.MeshPhongMaterial(defaultMaterials.defaultMechanism);
                    loadObjectsAndAssignMaterials(roata_only, roataMaterial, grupRoata);
                    loadObjectsAndAssignMaterials(baterie_only, testMaterial, grupBaterie);
                    loadObjectsAndAssignMaterials(filtru_only, testMaterial2, grupFiltru);
                    loadObjectsAndAssignMaterials(mecanism_only, testMaterial3, grupMecanism);
                    function loadObjectsAndAssignMaterials(array, defaultMaterial, groupName) {

                        array.forEach(function (name) {
//                            console.log(name);
                            objLoader.load('js/daes/OBJ/' + name + '.obj', function (object) {
                                object.traverse(function (child) {
                                    if (child instanceof THREE.Mesh) {
                                        child.material.map = texture;
                                    }
                                });
                                object.name = name;
                                object.scale.x = 0.5;
                                object.scale.y = 0.5;
                                object.scale.z = 0.5;
                                groupName.position.y = -600;
                                groupName.add(object);
                                object.children[0].material = defaultMaterial;
                                OBJ_count += 1;
//                                console.log(OBJ_count);
                            }, onProgress, onError);
//                            
                        });
                    }







//                    array_of_names.forEach(function (name) {
//                        objLoader.load('js/daes/OBJ/' + name + '.obj', function (object) {
//                            object.traverse(function (child) {
//                                if (child instanceof THREE.Mesh) {
//                                    child.material.map = texture;
//                                }
//                            });
//                            object.name = name;
//                            object.scale.x = 0.5;
//                            object.scale.y = 0.5;
//                            object.scale.z = 0.5;
//                            object.position.y = -30;
//                            scene.add(object);
//                            object.children[0].material = testMaterial;
//                        }, onProgress, onError);
//                    });


                }


                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///                    LOAD THE 3D MODELS                   ///
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////

                function basicColorizeOBJ() {
                    console.log("basicColorizeOBJ entered");
                    //HEIGHT
                    grupBaterie.position.y = -15;
                    grupFiltru.position.y = -15;
                    grupMecanism.position.y = -15;
                    grupBaterie.position.x = -9.45;
                    grupBaterie.position.z = 2;
                    grupFiltru.position.z = 2;
                    grupFiltru.position.x = 5.5;
                    grupMecanism.position.z = 2;
                    grupMecanism.position.x = 5.5;
                    grupRoata.position.y = -46;
                    colorizeConnectors(defaultMaterials.defaultConnectorMaterial);
                    colorizeBatteryInside(defaultMaterials.defaultBatteryInside);
                    colorizeGlass(defaultMaterials.defaultFilterGlass);
                    colorizeButtons(defaultMaterials.defaultFilter);
                    colorizeBattery(defaultMaterials.defaultBatterySupport);
                    colorizeFilter(defaultMaterials.defaultFilter);
                    colorizeTopAndBottom(defaultMaterials.topAndBottom);
                    colorizeScrews(defaultMaterials.defaultScrews);
                    colorizeMechanism(defaultMaterials.defaultMechanism);
                    colorizeLogos(defaultMaterials.defaultLogos);
                    colorizeScreenFrame(defaultMaterials.defaultScreenTransparent);
                    colorizeScreenGlass(defaultMaterials.defaultScreenTransparent);
                    colorizeScreenBackground(defaultMaterials.defaultScreenBackground);
                }


                function colorizeScreenBackground(materialColor) {
                    var screenBackground = scene.getObjectByName('ecran_behind');
                    screenBackground.position.x = 4.5;
//                    screenBackground.position.z = 10;
                    screenBackground.position.y = -6;
                    screenBackground.scale.x = 0.6;
                    screenBackground.scale.z = 0.6;
                    screenBackground.scale.y = 0.8;
                    screenBackground.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeScreenGlass(materialColor) {
                    var screenGlass = scene.getObjectByName('sticlaEcran');
                    if (screenGlass) {
                        screenGlass.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    }
                }

                function colorizeScreenFrame(materialColor) {
                    var screenFrame = scene.getObjectByName('ecran');
                    if (screenFrame) {
                        screenFrame.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    }

                }

                function colorizeConnectors(materialColor) {

                    var powerConnectors = scene.getObjectByName('partea_superioara_stecher');
                    var sipcaConnector = scene.getObjectByName('filet_capac_mecanism_tigara');
                    powerConnectors.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    sipcaConnector.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeBatteryInside(materialColor) {
                    var insideBattery = scene.getObjectByName('baterie');
                    var insideBatteryBottom = scene.getObjectByName('baterie_2');
                    insideBattery.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    insideBatteryBottom.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeLogos(materialColor) {
                    var filterLogo = scene.getObjectByName('logo_sipca');
                    var batteryLogo = scene.getObjectByName('logo_textura_baterie');
                    var bottomLogo = scene.getObjectByName('text_baterie_bottom');
                    var insideLogo = scene.getObjectByName('text_mecanism_interior');
                    filterLogo.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    batteryLogo.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    bottomLogo.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    insideLogo.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeMechanism(materialColor) {
                    var mechanism = scene.getObjectByName('shell_mecanism_tigara');
                    var mechanismBottom = scene.getObjectByName('partea_inferioara_stecher');
                    mechanism.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    mechanismBottom.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeGlass(materialColor) {
                    var sticla = scene.getObjectByName('sticla');
                    sticla.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }
                function colorizeButtons(materialColor) {
                    var bigButton = scene.getObjectByName('buton_mare');
                    var smallButton1 = scene.getObjectByName('buton_mic_1');
                    var smallButton2 = scene.getObjectByName('buton_mic_2');
                    bigButton.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    smallButton1.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    smallButton2.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }
                function colorizeBattery(materialColor) {
                    var batteryCover = scene.getObjectByName('invelis_baterie');
                    var sticla = scene.getObjectByName('sticla');
                    var usb = scene.getObjectByName('battery_usb');
                    usb.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    batteryCover.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    var sticlaColor = materialColor;
                    sticlaColor.transparent = true;
                    sticlaColor.opacity = 0.2;
                    sticla.children[0].material = new THREE.MeshPhongMaterial(sticlaColor);
                }
                function colorizeFilter(materialColor) {
                    var sipca = scene.getObjectByName('sipca');
                    var mechanismMagnet = scene.getObjectByName('buton_interior_mecanism_tigara');
                    sipca.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    mechanismMagnet.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function colorizeTopAndBottom(materialColor) {
                    var fund_mecanism_tigara = scene.getObjectByName('fund_mecanism_tigara');
                    var capac_mecanism_tigara = scene.getObjectByName('capac_mecanism_tigara');
                    var capac_baterie = scene.getObjectByName('capac_baterie');
                    var fund_baterie = scene.getObjectByName('fund_baterie');
                    fund_mecanism_tigara.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    capac_mecanism_tigara.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    capac_baterie.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    fund_baterie.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }
                function colorizeScrews(materialColor) {
                    var screwset1 = scene.getObjectByName('suruburi_capac_mecanism_tigara');
                    var screwset2 = scene.getObjectByName('suruburi_capac_baterie');
                    var screwset3 = scene.getObjectByName('suruburi_baterie');
                    var screwset4 = scene.getObjectByName('suruburi_fund_baterie');
                    var screwset5 = scene.getObjectByName('suruburi_fund_mecanism_tigara');
                    screwset1.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    screwset2.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    screwset3.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    screwset4.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                    screwset5.children[0].material = new THREE.MeshPhongMaterial(materialColor);
                }

                function basicColorize() {

                    var mecanism_tigara = scene.getObjectByName("mecanism_tigara");
                    var mecanism_tigara_mesh = mecanism_tigara.children[0];
                    var silverPolished = new THREE.MeshPhongMaterial({color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide});
                    mecanism_tigara_mesh.material = silverPolished;
                    var grupu = scene.getObjectByName("grupPrincipal");
                    var grupuchildren = grupu.children;
                    var filter_material = new THREE.MeshPhongMaterial({color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide});
                    var filter_mesh = scene.getObjectByName("Cylinder001").children[0];
                    filter_mesh.material = filter_material;
                    var white_glass_material = new THREE.MeshPhongMaterial({color: 0x777777, shininess: 10, specular: 0xDDDDDD, transparent: true, opacity: 0.5, side: THREE.DoubleSide});
                    var default_blueGlassMat = new THREE.MeshPhongMaterial({color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
                    var filter_glass_mesh = scene.getObjectByName("sticla001").children[0];
                    filter_glass_mesh.material = default_blueGlassMat;
                    var buttonsMaterial = new THREE.MeshPhongMaterial({color: 0xDDDDFF, shininess: 30, specular: 0xEEEEEE, metal: true, side: THREE.DoubleSide});
                    var bigButton_mesh = scene.getObjectByName("buton_mare").children[0];
                    bigButton_mesh.material = buttonsMaterial;
                    var smallButton1_mesh = scene.getObjectByName("buton_mic_1").children[0];
                    var smallButton2_mesh = scene.getObjectByName("buton_mic_2").children[0];
                    smallButton1_mesh.material = buttonsMaterial;
                    smallButton2_mesh.material = buttonsMaterial;
                    var rama_ecranMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 10, specular: 0xFFFFCC, side: THREE.DoubleSide});
                    var rama_ecran_mesh = scene.getObjectByName("rama_ecran").children[0];
                    rama_ecran_mesh.material = rama_ecranMaterial;
                }


                function displayDisruptorColourOptions() {

                    if (disruptor_colours_shown === false) {
                        console.log("SHOULD DISPLAY 3 COLOURS TO CHOOSE FROM FOR THE DISRUPTOR");
                        var boxGeometry = new THREE.BoxGeometry(25, 25, 25, 25);
                        var goldenMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.golden_material);
                        var silverMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.silver_material);
                        var blackMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.black_material);
                        var box1 = new THREE.Mesh(boxGeometry, goldenMaterial);
                        box1.name = "GoldenBox";
                        var box2 = new THREE.Mesh(boxGeometry, silverMaterial);
                        box2.name = "SilverBox";
                        var box3 = new THREE.Mesh(boxGeometry, blackMaterial);
                        box3.name = "BlackBox";
                        threeColourBoxes = new THREE.Group();
                        threeColourBoxes.name = "threeColourBoxes";
                        threeColourBoxes.add(box1);
                        threeColourBoxes.add(box2);
                        threeColourBoxes.add(box3);
                        if (battery_colours_shown) {
                            removeBatteryColourOptions();
                        }

                        scene.add(threeColourBoxes);
                        disruptor_colours_shown = true;
                    } else {
                        console.log("The 3 colour boxes already are on the screen.");
                    }
                }

                function removeDisruptorColourOptions() {

                    if (disruptor_colours_shown) {
                        console.log(scene);
                        threeColourBoxes = scene.getObjectByName("threeColourBoxes");
                        scene.remove(threeColourBoxes);
                        disruptor_colours_shown = false;
                    } else {
                        console.log("Cannot remove threeColourBoxes if they dont exist");
                    }
                }


                function displayBatteryColourOptions() {
                    if (battery_colours_shown === false) {
                        var boxGeometry = new THREE.BoxGeometry(16, 16, 16, 16);
//                        var mat1 = new THREE.MeshPhongMaterial({color: batteryColours.red});
//                        var mat2 = new THREE.MeshPhongMaterial({color: batteryColours.green});
//                        var mat3 = new THREE.MeshPhongMaterial({color: batteryColours.purple});
//                        var mat4 = new THREE.MeshPhongMaterial({color: batteryColours.blue});
//                        var mat5 = new THREE.MeshPhongMaterial({color: batteryColours.pink});
//                        var mat6 = new THREE.MeshPhongMaterial({color: batteryColours.black});
//                        var mat7 = new THREE.MeshPhongMaterial({color: batteryColours.whiteblue});
                        var mat1 = new THREE.MeshPhongMaterial(batteryMaterials.red_battery);
                        var mat2 = new THREE.MeshPhongMaterial(batteryMaterials.green_battery);
                        var mat3 = new THREE.MeshPhongMaterial(batteryMaterials.purple_battery);
                        var mat4 = new THREE.MeshPhongMaterial(batteryMaterials.blue_battery);
                        var mat5 = new THREE.MeshPhongMaterial(batteryMaterials.pink_battery);
                        var mat6 = new THREE.MeshPhongMaterial(batteryMaterials.black_battery);
                        var mat7 = new THREE.MeshPhongMaterial(batteryMaterials.whiteblue_battery);
                        var box1 = new THREE.Mesh(boxGeometry, mat1);
                        box1.name = "batteryColour_box1";
                        var box2 = new THREE.Mesh(boxGeometry, mat2);
                        box2.name = "batteryColour_box2";
                        var box3 = new THREE.Mesh(boxGeometry, mat3);
                        box3.name = "batteryColour_box3";
                        var box4 = new THREE.Mesh(boxGeometry, mat4);
                        box4.name = "batteryColour_box4";
                        var box5 = new THREE.Mesh(boxGeometry, mat5);
                        box5.name = "batteryColour_box5";
                        var box6 = new THREE.Mesh(boxGeometry, mat6);
                        box6.name = "batteryColour_box6";
                        var box7 = new THREE.Mesh(boxGeometry, mat7);
                        box7.name = "batteryColour_box7";
                        sevenColourBoxes = new THREE.Group();
                        sevenColourBoxes.name = "sevenColourBoxes";
                        sevenColourBoxes.add(box1);
                        sevenColourBoxes.add(box2);
                        sevenColourBoxes.add(box3);
                        sevenColourBoxes.add(box4);
                        sevenColourBoxes.add(box5);
                        sevenColourBoxes.add(box6);
                        sevenColourBoxes.add(box7);
                        scene.add(sevenColourBoxes);
                        if (disruptor_colours_shown) {
                            removeDisruptorColourOptions();
                        }
                        battery_colours_shown = true;
                    } else {
                        console.log("The 7 colour boxes already are on the screen.");
                    }
                }


                function removeBatteryColourOptions() {

                    if (battery_colours_shown) {
                        sevenColourBoxes = scene.getObjectByName("sevenColourBoxes");
                        scene.remove(sevenColourBoxes);
                        battery_colours_shown = false;
                    } else {
                        console.log("Cannot remove sevenColourBoxes if they dont exist");
                    }


                }

                function changeMecanismColor(color) {
                    console.log("attempting to change mechanism color to " + color);
                    var mecanism_tigara_mesh = scene.getObjectByName("mecanism_tigara").children[0];
                    switch (color) {
                        case "black":
                            var blackBatteryMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = blackBatteryMaterial;
                            break;
                        case "gold":
                            var goldPolished = new THREE.MeshPhongMaterial({color: 0xEAE0D7, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = goldPolished;
                            break;
                        case "silver":
                            var silverPolished = new THREE.MeshPhongMaterial({color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = silverPolished;
                            break;
                        default:
                            console.log("The colors you must chose are : black, gold or silver");
                            break;
                    }
                }

                function innokinSplitInThree() {
                    var mechanism = scene.getObjectByName('grupPrincipal');
                    var filter = scene.getObjectByName('grupFiltru');
                    var battery = scene.getObjectByName('grupBaterie');
                    if (object_is_not_split) {
                        mechanism.position.x -= 20;
                        filter.position.x = 0;
                        filter.position.y += 0;
                        battery.position.x += 20;
                        object_is_not_split = false;
                    } else {
                        mechanism.position.x = 0;
                        mechanism.position.y = -15;
                        mechanism.position.z = 0;
                        filter.position.x = 0;
                        filter.position.y = -15;
                        battery.position.x = -14.95;
                        battery.position.y = -15;
                        object_is_not_split = true;
                    }
                }
//                function changeBatteryColor(color) {
//                    console.log("attempting to change batery cover color to " + color);
//                    var batterySupport_mesh = batterySupport.children[0].children[0];
//                    var filter_glass_mesh = scene.getObjectByName("sticla001").children[0];
//                    switch (color) {
//                        case "black":
//                            var blackBatteryMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide});
//                            var blackGlassMat = new THREE.MeshPhongMaterial({color: 0x010101, shininess: 10, specular: 0x030303, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
//                            batterySupport_mesh.material = blackBatteryMaterial;
//                            filter_glass_mesh.material = blackGlassMat;
//                            break;
//                        case "blue":
//                            var blueBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0x009EFA, shininess: 50, specular: 0x009EFA, metal: true, side: THREE.DoubleSide});
//                            var blueGlassMat = new THREE.MeshPhongMaterial({color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
//                            batterySupport_mesh.material = blueBatterySupportMaterial;
//                            filter_glass_mesh.material = blueGlassMat;
//                            break;
//                        case "pink":
//                            var pinkBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide});
//                            var pinkGlassMat = new THREE.MeshPhongMaterial({color: 0xFA55BB, shininess: 10, specular: 0xFA55BB, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
//                            batterySupport_mesh.material = pinkBatterySupportMaterial;
//                            filter_glass_mesh.material = pinkGlassMat;
//                            break;
//                        default:
//                            console.log("The colors you must chose are : black, blue or pink");
//                            break;
//                    }
//                }

                function playButonMareAction() {

                    if (startButtonCounter % 6 == 0) {
                        console.log(scene);
                        grupParticule = scene.getObjectByProperty('type', 'PointCloud');
                        console.log(grupParticule);
                        emitter = null;
                        particleGroup = null;
                        scene.remove(grupParticule);
                    } else if (startButtonCounter % 3 == 0) {
                        initParticles();
                    }

                }


                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///                        TWEENS                           ///
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////

                function setupTweenBatteryOut()
                {
                    batteryGroup = scene.getObjectByName("grupBaterie");
                    var update = function () {
                        batteryGroup.position.y = current.y;
                        batteryGroup.position.x = current.x;
                        batteryGroup.position.z = current.z;
                    }
                    console.log("Battery Current Position");
                    console.log(batteryGroup.position);
                    var current = {x: -14.95, y: -30, z: 0};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    var easing2 = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    // build the tween lift the battery from the support
                    tweenBatteryUp = new TWEEN.Tween(current)
                            .to({y: +userOpts.liftoff}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing2)
                            .onUpdate(update);
                    tweenBatteryOut = new TWEEN.Tween(current)
                            .to({x: +userOpts.range}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(easing2)
                            .onUpdate(update);
                    tweenBatteryUp.chain(tweenBatteryOut);
                    // start the first
                }

                function setupTweenBatteryIn()
                {
                    var complete = function () {
                        console.log("BATTERY ATTACHED. PLAYING A CLICK SOUND !");
                        setTimeout(function () {
//                            alert("PLAYING CLICK SOUND NOW");
                        }, 300);
                    }

                    var update = function () {
                        batteryGroup.position.x = current.x;
                        batteryGroup.position.y = current.y;
                        batteryGroup.position.z = current.z;
                    }
                    var current = {x: 2000, y: userOpts.liftoff, z: -30};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: -14.95, y: 10, z: 0}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: -14.95, y: -30, z: 0}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update)
                            .onComplete(complete);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);
                }

                function setupTweenFilterRotate()
                {
                    var update = function () {
                        filtruTigara.rotation.y = current.rotY;
                        filtruTigara.position.x = current.x;
                        filtruTigara.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff, rotY: 0};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
//                    tweenFilterRotate = new TWEEN.Tween(current)
//                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(quintic)
//                            .onUpdate(update);
                    // build the tween to go backward
//                    tweenBatteryDown = new TWEEN.Tween(current)
//                            .to({x: 15, y: 0}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
//                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }

                function setupTweenFilterGoUp()
                {
                    // 
                    var update = function () {
                        chargerCube.position.x = current.x;
                        chargerCube.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: 15, y: 0}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update);
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }

                function setupTweenFilterGoOut()
                {
                    // 
                    var update = function () {
                        chargerCube.position.x = current.x;
                        chargerCube.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: 15, y: 0}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update);
                    colladaLoader
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }

                function addControls() {
                    if (pbc_debug) {
                        var remoteControlTexture = new THREEx.DynamicTexture(400, 200);
                        remoteControlTexture.texture.anisotropy = renderer.getMaxAnisotropy();
                        var remoteGeometry1 = new THREE.PlaneBufferGeometry(45, 20, 30, 30);
//                        var planeGeometry2 = new THREE.PlaneBufferGeometry(112, 50, 30, 30);
                        var remoteMaterial = new THREE.MeshBasicMaterial({
                            map: remoteControlTexture.texture
                        });
                        var remoteControl = new THREE.Mesh(remoteGeometry1, remoteMaterial);
                        remoteControl.name = 'remoteControl';
//                        var LargeScreen = new THREE.Mesh(planeGeometry2, planeMaterial);
//                        LargeScreen.name = 'largeScreen';
//                        var optionsGroup = scene.getObjectByName('optionsGroup');

//                    remoteControl.position.x = -15.8;  // DEPTH BIGGER IS INSIDE
//                    remoteControl.position.z = -1.9; // LEFT RIGHT (smaller is LEFT
//                    remoteControl.position.y = 13; // TOP BOTTOM
                        remoteControl.rotation.z = Math.PI / 2;
                        remoteControl.rotation.y = -Math.PI / 2;
                        remoteControlTexture.texture.needsUpdate = true;
                        remoteControlTexture.clear('#667788');
//                        var logoImage = "LogoInokin.png";
//                        var logoImage = document.getElementById("logoImage");
//                        screenDynamicTexture.drawImage(logoImage, 20, 50);
                        remoteControlTexture.drawTextCooked(
                                {
//                                    margin: 0.3,
                                    align: 'center',
                                    text: '          BUTTON1',
                                    lineHeight: 0.35,
                                    fillStyle: '#FDFDFD',
                                    font: "bold " + (0.2 * 190) + "px Arial"
                                }
                        );
//                    var optionGeometry = new THREE.BoxGeometry(50, 25, 1, 1);
//                    var mat1 = new THREE.MeshPhongMaterial(optionsMaterials.red);
//                    var mat2 = new THREE.MeshPhongMaterial(optionsMaterials.blue);
//                    var mat3 = new THREE.MeshPhongMaterial(optionsMaterials.green);
////                    alert("addin controls to the screen");
//                    var option1 = new THREE.Mesh(optionGeometry, mat1);
//                    option1.name = "option1_box";
//                    var option2 = new THREE.Mesh(optionGeometry, mat2);
//                    option2.name = "option2_box";
//                    var option3 = new THREE.Mesh(optionGeometry, mat3);
//                    option2.name = "option3_box";
//
//
                        optionsGroup = new THREE.Group();
                        optionsGroup.name = "optionsGroup";
                        scene.add(optionsGroup);
                        optionsGroup.add(remoteControl);
//
//                    optionsGroup.add(option1);
//                    optionsGroup.add(option2);
//                    optionsGroup.add(option3);
////                    for (i= 1 ; i<= option.length ; i++){
////                         optionsGroup.add('option'+i);
////                    }
////                    

                    }
                }


                function setRemoteVisible() {

                    if (pbc_debug) {
                        remoteDiv = document.getElementById("remoteDiv");
                        remoteDiv.style.display = "inline";
//                    console.log(remoteDiv);
////                    remoteDiv.style.display = "true";
//                    console.log(remoteDiv);

//        console.log(document.getElementById('remoteDiv'));
                    }

                }

                function test() {

                    var height_for_all = -15.5;
                    var geometry = new THREE.CylinderGeometry(8, 7, 2, 60);
                    var material1 = new THREE.MeshBasicMaterial({color: 0xffff00});
                    var material2 = new THREE.MeshBasicMaterial({color: 0x00ff00});
                    var material3 = new THREE.MeshBasicMaterial({color: 0x0033FF});
                    var material4 = new THREE.MeshBasicMaterial({color: 0xFF33FF});
                    var material5 = new THREE.MeshBasicMaterial({color: 0xFF3300});
                    var material6 = new THREE.MeshBasicMaterial({color: 0x663311});
                    var material7 = new THREE.MeshBasicMaterial({color: 0xCACA33});
                    var material8 = new THREE.MeshBasicMaterial({color: 0xFF0000});
                    var cylinder1 = new THREE.Mesh(geometry, material1);
                    cylinder1.name = "testCylinder1";
                    scene.add(cylinder1);
                    cylinder1.position.x = 22;
                    cylinder1.position.z = 22;
                    cylinder1.position.y = height_for_all;
                    var cylinder2 = new THREE.Mesh(geometry, material2);
                    cylinder2.name = "testCylinder2";
                    scene.add(cylinder2);
                    cylinder2.position.x = 31;
                    cylinder2.position.z = 0;
                    cylinder2.position.y = height_for_all;
                    var cylinder3 = new THREE.Mesh(geometry, material3);
                    cylinder3.name = "testCylinder3";
                    scene.add(cylinder3);
                    cylinder3.position.x = -31;
                    cylinder3.position.z = 0;
                    cylinder3.position.y = height_for_all;
                    var cylinder4 = new THREE.Mesh(geometry, material4);
                    cylinder4.name = "testCylinder4";
                    scene.add(cylinder4);
                    cylinder4.position.x = -22;
                    cylinder4.position.z = -22;
                    cylinder4.position.y = height_for_all;
                    var cylinder5 = new THREE.Mesh(geometry, material5);
                    cylinder5.name = "testCylinder5";
                    scene.add(cylinder5);
                    cylinder5.position.x = -22;
                    cylinder5.position.z = 22;
                    cylinder5.position.y = height_for_all;
                    var cylinder6 = new THREE.Mesh(geometry, material6);
                    cylinder6.name = "testCylinder6";
                    scene.add(cylinder6);
                    cylinder6.position.x = 22;
                    cylinder6.position.z = -22;
                    cylinder6.position.y = height_for_all;
                    var cylinder7 = new THREE.Mesh(geometry, material7);
                    cylinder7.name = "testCylinder7";
                    scene.add(cylinder7);
                    cylinder7.position.x = 0;
                    cylinder7.position.z = 31;
                    cylinder7.position.y = height_for_all;
                    var cylinder8 = new THREE.Mesh(geometry, material8);
                    cylinder8.name = "testCylinder8";
                    scene.add(cylinder8);
                    cylinder8.position.x = 0;
                    cylinder8.position.z = -31;
                    cylinder8.position.y = height_for_all;
                }


                function moveXplus(objectName) {

                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.x += 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }

                function moveXminus(objectName) {
                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.x -= 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }
                function moveYplus(objectName) {
                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.y += 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }
                function moveYminus(objectName) {
                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.y -= 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }
                function moveZplus(objectName) {
                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.z += 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }
                function moveZminus(objectName) {
                    var object = scene.getObjectByName(objectName);
                    if (object) {
                        object.position.z -= 1 * scale_to_move;
                        console.log(object.position);
                    } else {
                        console.log("Object " + objectName + " does not exist on the screen");
                    }
                }


                function load8times() {
                    var batteryChoicesGroup = new THREE.Group();
                    batteryChoicesGroup.name = "batteryChoicesGroup";
                    scene.add(batteryChoicesGroup);
                    var materials = [
                        new THREE.MeshBasicMaterial({color: 0xffff00}),
                        new THREE.MeshBasicMaterial({color: 0x00ff00}),
                        new THREE.MeshBasicMaterial({color: 0x0033FF}),
                        new THREE.MeshBasicMaterial({color: 0xFF33FF}),
                        new THREE.MeshBasicMaterial({color: 0xFF3300}),
                        new THREE.MeshBasicMaterial({color: 0x663311}),
                        new THREE.MeshBasicMaterial({color: 0xCACA33}),
                        new THREE.MeshBasicMaterial({color: 0xFF0000}),
                    ];
//                    var mat1 = new THREE.MeshPhongMaterial(batteryMaterials.red_battery);
//                    var mat2 = new THREE.MeshPhongMaterial(batteryMaterials.green_battery);
//                    var mat3 = new THREE.MeshPhongMaterial(batteryMaterials.purple_battery);
//                    var mat4 = new THREE.MeshPhongMaterial(batteryMaterials.blue_battery);
//                    var mat5 = new THREE.MeshPhongMaterial(batteryMaterials.pink_battery);
//                    var mat6 = new THREE.MeshPhongMaterial(batteryMaterials.black_battery);
//                    var mat7 = new THREE.MeshPhongMaterial(batteryMaterials.whiteblue_battery);
                    var general_height = -36;
                    var name = 'invelis_baterie';
                    for (var i = 0; i < 8; i++) {
//                        var material1 = new THREE.MeshBasicMaterial({color: 0xffff00});
                        var material1 = materials[i];
                        objLoader.load('js/daes/OBJ/' + name + '.obj', function (object) {


                            object.traverse(function (child) {
                                if (child instanceof THREE.Mesh) {
                                    child.material.map = texture;
                                }
                            });
                            object.name = 'testbaterie' + i;
                            object.scale.x = 0.5;
                            object.scale.y = 0.5;
                            object.scale.z = 0.5;
                            console.log(object);
                            switch (i) {
                                case 0:
                                    object.position.x = 16;
                                    object.position.y = general_height;
                                    object.position.z = 2;

                                    //NO ROTATION NEEDED @ THIS
//                                    object.rotation.y = Math.PI/4;
                                    break;
                                case 2:
                                    //IF NOT ROTATED
//                                    object.position.x = -15;
//                                    object.position.y = general_height;
//                                    object.position.z = 33;
                                    //IF ROTATED
                                    object.position.x = -2;
                                    object.position.y = general_height;
                                    object.position.z = 16;


                                    object.rotation.y = -Math.PI / 2;
                                    break;
                                case 1:
                                    //IF NOT ROTATED
//                                    object.position.x = 7;
//                                    object.position.y = general_height;
//                                    object.position.z = 24;
                                    //IF ROTATED
                                    object.position.x = 10;
                                    object.position.y = general_height;
                                    object.position.z = 12.5;
                                    object.rotation.y = -Math.PI / 4;
                                    break;
                                case 3:
                                    //IF NOT ROTATED
//                                    object.position.x = -37;
//                                    object.position.y = general_height;
//                                    object.position.z = 24;
                                    //IF ROTATED
                                    object.position.x = -13;
                                    object.position.y = general_height;
                                    object.position.z = 10;

                                    object.rotation.y = -3 * Math.PI / 4;
//                                    object.rotation.y += 0.5;

                                    break;
                                    ///x=-37y=-32z=24
                                case 4:
                                    //IF NOT ROTATED
//                                    object.position.x = -46;
//                                    object.position.y = general_height + 5 * i;
//                                    object.position.z = 1.5;
                                    //IF ROTATED
                                    object.position.x = -16.2;
                                    object.position.y = general_height;
                                    object.position.z = -1.8;
                                    object.rotation.y = Math.PI;
                                    break;
                                case 5:
                                    //IF NOT ROTATED
//                                    object.position.x = -37;
//                                    object.position.y = general_height + 5 * i;
//                                    object.position.z = -20;
                                    //IF ROTATED
                                    object.position.x = -10.2;
                                    object.position.y = general_height;
                                    object.position.z = -12.7;
                                    object.rotation.y = 3 * Math.PI / 4;
                                    break;
                                case 6:
                                    //IF NOT ROTATED
//                                    object.position.x = -14.7;
//                                    object.position.y = general_height + 5 * i;
//                                    object.position.z = -29;
                                    //IF ROTATED
                                    object.position.x = 1.8;
                                    object.position.y = general_height;
                                    object.position.z = -16.2;
                                    object.rotation.y = 2 * Math.PI / 4;
                                    break;
                                case 7:
                                    //IF NOT ROTATED
//                                    object.position.x = 7;
//                                    object.position.y = general_height + 5 * i;
//                                    object.position.z = -20.5;
                                    //IF ROTATED
                                    object.position.x = 13;
                                    object.position.y = general_height;
                                    object.position.z = -10;
                                    object.rotation.y = Math.PI / 4;
                                    break;
                            }

//                          new THREE.GeometryUtils.center(object);


//                        object.position = correctposition;

//                        groupName.position.y = -600;
//                        groupName.add(object);
//                        groupName.position.y = -600;
                            batteryChoicesGroup.add(object);
                            object.children[0].material = material1;
//                        OBJ_count += 1;

                        }, onProgress, onError);
                    }
                    console.log(scene);
                }



        </script>
    </body>
</html>
