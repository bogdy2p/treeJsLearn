<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - InnoKin Sketch</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                color: #cccccc;
                font-family:Monospace;
                font-size:13px;
                text-align:center;

                background-color: #000000;
                margin: 0px;
                overflow: hidden;
            }

            #info {
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
            }

            a {

                color: #0080ff;
            }

            #leftcontrols {
                position: absolute;
                bottom: 0px; width: 100%;
                height: 30px;
                padding: 5px;
                background-color: #FF66FF;
            }
            #container{
                position: absolute; left:0px; top:0px;
            }
        </style>
    </head>
    <body>

        <div id="container"></div>
        <div id="info">
            <a href="http://threejs.org" target="_blank">three.js</a> webgl - Innoking sketch  - by <a href="https://twitter.com/fernandojsg">ThePBC</a>
        </div>
        <div id ="leftcontrols">


            <!--            <button id="btn21" onclick="changeMecanismColor('black');">M.Black</button>
                        <button id="btn22" onclick="changeMecanismColor('gold');">M.Gold</button>
                        <button id="btn23" onclick="changeMecanismColor('silver');">M.Silver</button>
                        <button id="btn24" onclick="changeBatteryColor('black');">Bat.Black</button>
                        <button id="btn25" onclick="changeBatteryColor('blue');">Bat.Blue</button>
                        <button id="btn26" onclick="changeBatteryColor('pink');">Bat.Pink</button>-->

            <button id="btn1" onclick="switchBattery();">Button1-Switch Battery</button>

            <!--            <button id="btn2" onclick="test();">TEST</button>
                        <button id="btn3" onclick="butonmic1();">Button mic 1</button>-->
            <button id="btn4" onclick="displayDisruptorColourOptions();">Display Disruptor Colors</button>
            <!--<button id="btn7" onclick="removeDisruptorColourOptions();">Remove Disruptor Colors</button>-->
            <button id="btn5" onclick="displayBatteryColourOptions();">BatteryColors</button>
            <!--<button id="btn5" onclick="removeBatteryColourOptions();">RemoveBatColors</button>-->
            <button id="btn6" onclick="test();">test</button>

        </div>

        <script src="js/three.min.js"></script>
        <script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/libs/stats.min.js"></script>
        <script src ="js/ColladaLoader.js"></script>
        <script src ="js/OBJLoader.js"></script>
        <script src="js/Tween.js"></script>
        <script src="dat-gui/build/DAT.GUI.js"></script>


        <script src="js/ShaderParticles.min.js"></script>
        <script src="js/ShaderParticleGroup.js"></script>
        <script src="js/ShaderParticleEmitter.js"></script>

        <script>

                var group, grupFiltru, grupBaterie, group2, group3;
                var disruptor;
                var battery;
                var container, mapCanvas;
                var controls, controls2;
                var camera, mapCamera, scene, renderer, raycaster, raycasterMap;
                var positions, colors;
                var mouseX = 0, mouseY = 0;
                var mouseXOnMouseDown = 0;
                var SCREEN_WIDTH, SCREEN_HEIGHT;
                var targetRotation = 0;
                var startButton, minusButtonCylinder, plusButtonCylinder, filtruTigara, chargerCube, disrupterCube;
                var targetRotationOnMouseDown = 0;
                var windowHalfX = window.innerWidth / 2;
                var windowHalfY = window.innerHeight / 2;
                var pointLight;
                var startButtonCounter = 0;
                var chargerMaterial;
                var tweenBatteryOut, tweenBatteryIn, tweenBatteryUp, tweenBatteryDown;
                var startTime = Date.now();
                var emitter, particleGroup;
                var disruptor_colours_shown = false;
                var battery_colours_shown = false;
                var disruptorColours = {
                    black: 0xFFFFFF,
                    black_specular: 0x040404,
                    gold: 0xEAE0D7,
                    gold_specular: 0xEAE0D7,
                    silver: 0xE4E4EE,
                    silver_specular: 0xE4E4EE,
                };
                var batteryColours = {
                    red: 0xEF2A5F,
                    red_specular: 0xEF2A5F,
                    green: 0x00AE73,
                    green_specular: 0x00AE73,
                    purple: 0xB149BC,
                    purple_specular: 0xB149BC,
                    blue: 0x0280EE,
                    blue_specular: 0x0280EE,
                    pink: 0xDF037F,
                    pink_specular: 0xDF037F,
                    black: 0x2F2D38,
                    black_specular: 0x2F2D38,
                    whiteblue: 0x8EDCE8,
                    whiteblue_specular: 0x8EDCE8,
                };
                var disruptorMaterials = {
                    silver_material: {color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide},
                    black_material: {color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide},
                    golden_material: {color: 0xEAE0D7, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide},
                };

                var defaultMaterials = {
                    defaultBatterySupport: {color: 0x009EFA, shininess: 50, specular: 0x009EFA, metal: true, side: THREE.DoubleSide},
                    defaultMechanism: {color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide},
                    defaultFilter: {color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide},
//                    defaultFilterG;aa
                }
//                  var filter_material = new THREE.MeshPhongMaterial({color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide});
//                  var white_glass_material = new THREE.MeshPhongMaterial({color: 0x777777, shininess: 10, specular: 0xDDDDDD, transparent: true, opacity: 0.5, side: THREE.DoubleSide});
//                  var default_blueGlassMat = new THREE.MeshPhongMaterial({color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
//                  var buttonsMaterial = new THREE.MeshPhongMaterial({color: 0xDDDDFF, shininess: 30, specular: 0xEEEEEE, metal: true, side: THREE.DoubleSide});
//                  var rama_ecranMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 10, specular: 0xFFFFCC, side: THREE.DoubleSide});





                var batteryMaterials = {
                    black_battery: {color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide},
                    black_glass: {color: 0x010101, shininess: 10, specular: 0x030303, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
//                                batterySupport_mesh.material = blackBatteryMaterial;
//                                filter_glass_mesh.material = blackGlassMat;
                    blue_battery: {color: 0x009EFA, shininess: 50, specular: 0x009EFA, metal: true, side: THREE.DoubleSide},
                    blue_glass: {color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
//                                batterySupport_mesh.material = blueBatterySupportMaterial;
//                                filter_glass_mesh.material = blueGlassMat;
                    pink_battery: {color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide},
                    pink_glass: {color: 0xFA55BB, shininess: 10, specular: 0xFA55BB, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
//                                batterySupport_mesh.material = pinkBatterySupportMaterial;
//                                filter_glass_mesh.material = pinkGlassMat;
                    red_battery: {color: 0xFF6677, shininess: 30, specular: 0x990000, metal: true, side: THREE.DoubleSide},
                    red_glass: {color: 0xFF6677, shininess: 10, specular: 0x990000, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
                    green_battery: {color: 0x00FF00, shininess: 50, specular: 0x00FF00, metal: true, side: THREE.DoubleSide},
                    green_glass: {color: 0x000000, shininess: 10, specular: 0x000000, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
                    purple_battery: {color: 0xFF00FF, shininess: 50, specular: 0xFF00FF, metal: true, side: THREE.DoubleSide},
                    purple_glass: {color: 0x000000, shininess: 10, specular: 0x000000, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
                    whiteblue_battery: {color: 0x000000, shininess: 50, specular: 0x000000, metal: true, side: THREE.DoubleSide},
                    whiteblue_glass: {color: 0x000000, shininess: 10, specular: 0x000000, transparent: true, opacity: 0.6, side: THREE.DoubleSide},
                };
                var userOpts = {
                    liftoff: 20,
                    range: 2000,
                    duration: 1500,
                    delay: 0,
                    easing: 'Exponential.EaseIn',
                    quintic_in: 'Quintic.EaseOut',
                }


                document.addEventListener('mousemove', onDocumentMouseMove, false);
                init();
                animate();
                function init() {
                    container = document.getElementById('container');
                    scene = new THREE.Scene();
                    raycaster = new THREE.Raycaster();
                    clock = new THREE.Clock();
                    SCREEN_WIDTH = window.innerWidth;
                    SCREEN_HEIGHT = window.innerHeight;
                    var ASPECT_RATIO = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera = new THREE.PerspectiveCamera(50, ASPECT_RATIO, 1, 600);
                    camera.position.x = -120;
                    camera.position.z = 100;
                    camera.position.y = -80;
                    scene.add(camera);
                    controls = new THREE.OrbitControls(camera, container);
                    controls.noZoom = false;
                    controls.minDistance = 80;
                    controls.maxDistance = 180;
                    controls.noPan = true;
                    var luminaDirectionala1 = new THREE.DirectionalLight(0xffffff, 0.4);
                    luminaDirectionala1.position.set(600, 600, 600);
                    luminaDirectionala1.name = "luminaDirectionala1";
                    scene.add(luminaDirectionala1);
                    var luminaDirectionala2 = new THREE.DirectionalLight(0xffffff, 0.4);
                    luminaDirectionala2.position.set(600, -600, 600);
                    luminaDirectionala2.name = "luminaDirectionala2";
                    scene.add(luminaDirectionala2);
                    pointLight = new THREE.PointLight(0xcccccc, 0.3);
                    pointLight.position.set(20, 20, 20);
                    scene.add(pointLight);
                    group = new THREE.Group();
                    group.name = "grupPrincipal";
                    scene.add(group);
                    grupFiltru = new THREE.Group();
                    grupFiltru.name = "grupFiltru";
                    scene.add(grupFiltru);
                    grupBaterie = new THREE.Group();
                    grupBaterie.name = "grupBaterie";
                    scene.add(grupBaterie);
                    //load the 3d Model files
                    //////////////////////////////////////////////

//                    load3DOBJmodels();
                    load3Dmodels();
                    //////////////////////////////////////////////
                    // Add Charger 
                    //Grosime,Lungime,Latime
                    setTimeout(function () {
                        basicColorize();
//                        displayDisruptorOptions();
                    }, 2800);
                    renderer = new THREE.WebGLRenderer({antialias: true});
                    renderer.setClearColor(0x559955, 1);
                    renderer.setPixelRatio(window.devicePixelRatio);
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.gammaInput = true;
                    renderer.gammaOutput = true;
                    container.appendChild(renderer.domElement);
                    renderer.domElement.addEventListener('mousedown', onDocumentMouseDown, false);
                    renderer.domElement.addEventListener('touchstart', onDocumentTouchStart, false);
                    renderer.domElement.addEventListener('touchmove', onDocumentTouchMove, false);
                    window.addEventListener('resize', onWindowResize, false);
//                    renderer.autoClear = false;


                }

                function initParticles() {
                    particleGroup = new SPE.Group({
                        texture: THREE.ImageUtils.loadTexture('images/smokeparticle.png'),
                        maxAge: 5,
                        hasPerspective: true,
                        colorize: true
                    });
                    emitter = new SPE.Emitter({
                        position: new THREE.Vector3(-4, 0, 75),
                        positionSpread: new THREE.Vector3(0, 0, 0),
                        acceleration: new THREE.Vector3(0, 0, 30),
                        accelerationSpread: new THREE.Vector3(0, 0, 10),
                        velocity: new THREE.Vector3(0, 0, 0),
                        velocitySpread: new THREE.Vector3(20, 20, 20),
                        colorStart: new THREE.Color(0x111111),
                        colorEnd: new THREE.Color(0x000000),
                        sizeStart: 25,
                        sizeEnd: 500,
                        particleCount: 100,
                    });
                    particleGroup.addEmitter(emitter);
                    scene.add(particleGroup.mesh);
                }



                function onWindowResize() {

                    windowHalfX = window.innerWidth / 2;
                    windowHalfY = window.innerHeight / 2;
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }

                function animate() {

                    requestAnimationFrame(animate);
                    render(clock.getDelta());
                    TWEEN.update();
                }

                function restartEngine(parameters)
                {

                    engine.destroy();
                    engine = new ParticleEngine();
                    engine.setValues(parameters);
                    engine.initialize();
                }


                function onDocumentMouseDown(event) {
                    event.preventDefault();
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                    var mouseVector = new THREE.Vector3();
                    mouseVector.x = 2 * (event.clientX / SCREEN_WIDTH) - 1;
                    mouseVector.y = 1 - 2 * (event.clientY / SCREEN_HEIGHT);
                    raycaster.setFromCamera(mouseVector, camera);
                    var intersectedObjects = raycaster.intersectObjects(scene.children, true);
                    if (intersectedObjects.length > 0) {

                        var Object = intersectedObjects[0];

                        switch (Object.object.parent.name) {

                            case 'sevenColourBoxes':


                                temp_material = Object.object.material;
                                var batterySupport_mesh = batterySupport.children[0].children[0];
                                var filter_glass_mesh = scene.getObjectByName("sticla001").children[0];
                                batterySupport_mesh.material = temp_material;
                                removeBatteryColourOptions();
                                break;
                            case 'threeColourBoxes':
                                mechanism_temp_material = Object.object.material;
                                var mecanism_tigara_mesh = scene.getObjectByName("mecanism_tigara").children[0];
                                mecanism_tigara_mesh.material = mechanism_temp_material;
                                removeDisruptorColourOptions();
                                break;
                            case 9:
                                console.log("You clicked the disruptor");
                                break;
                            case 'buton_mare':
                                console.log("Lighter should START");
                                startButtonClick();
                                startButtonCounter += 1;
                                playButonMareAction();
                                break;
                            case 'buton_mic_1':
                                console.log("You pressed the +");
                                plusButtonClick();
                                restartEngine(Examples.smoke);
                                break;
                            case 'buton_mic_2':
                                console.log("You pressed the -");
                                minusButtonClick();
                                break;
                            case 13:
                                console.log("Why did you click the screen ?");
                                break;
                            case 14:
                                console.log("Why click the Filter ?");
                                break;
                            default:
//                                console.log(Object.object.name);
//                                console.log("UNKNOWN CLICK. ID OR NAME NOT RECOGNIZED");
//                                console.log(Object);
                                break;
                        }

                    }

                }

                function onDocumentMouseMove(event) {

                    mouseX = event.clientX - windowHalfX;
                    targetRotationX = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.002;
                }

                function onDocumentMouseUp(event) {
                    renderer.domElement.addEventListener(
                            'mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                    resetButtonPositions();
                }

                function onDocumentMouseOut(event) {
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                }

                function onDocumentTouchStart(event) {
//                    alert("TOUCH DETECTED");
//                    alert(event);
                }

                function onDocumentTouchMove(event) {
//                    alert("TOUCH MOVEMENT DETECTED");
                }

                function startButtonClick() {

                    console.log("ENTERED STARTBUTTON CLICKED");
                    startButton.position.x += 0.3;
                }

                function plusButtonClick() {
                    console.log("plusbuttonclick function");
                    buttonSmall1.position.x += 0.3;
                }

                function minusButtonClick() {
                    console.log("Minusbutton click fubatterySupport_meshnction");
                    buttonSmall2.position.x += 0.3;
                }

                function resetButtonPositions() {

                    startButton.position.x = 1.5;
                    buttonSmall1.position.x = 1.5;
                    buttonSmall2.position.x = 1.5;
                }

                function render(dt) {
                    if (particleGroup) {
                        particleGroup.tick(dt);
                    }
                    var rotationSpeed = 10;
                    threeBoxesGroup = scene.getObjectByName("threeColourBoxes");
                    if (threeBoxesGroup) {
                        goldenBox = threeBoxesGroup.children[0];
                        silverBox = threeBoxesGroup.children[1];
                        blackBox = threeBoxesGroup.children[2];
                        goldenBox.position.copy(camera.position);
                        goldenBox.rotation.copy(camera.rotation);
                        goldenBox.updateMatrix();
                        goldenBox.translateZ(-300);
                        goldenBox.translateX(40);
                        goldenBox.translateY(100);
                        silverBox.position.copy(camera.position);
                        silverBox.rotation.copy(camera.rotation);
                        silverBox.updateMatrix();
                        silverBox.translateZ(-300);
                        silverBox.translateX(-40);
                        silverBox.translateY(100);
                        blackBox.position.copy(camera.position);
                        blackBox.rotation.copy(camera.rotation);
                        blackBox.updateMatrix();
                        blackBox.translateZ(-300);
                        blackBox.translateX(-00);
                        blackBox.translateY(100);
                    }
                    sevenBoxesGroup = scene.getObjectByName("sevenColourBoxes");
                    if (sevenBoxesGroup) {
                        var boxes = [];
                        for (i = 0; i < 7; i++) {
                            boxes[i] = sevenBoxesGroup.children[i];
                            boxes[i].position.copy(camera.position);
                            boxes[i].rotation.copy(camera.rotation);
                            boxes[i].translateZ(-300);
                            boxes[i].translateY(100);
                            boxes[i].translateX(-110 + 40 * i);
                        }
                    }

                    var newlightposition = camera.position;
                    pointLight.position.set(camera.position.x, camera.position.y, camera.position.z);
                    var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
                    camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera.updateProjectionMatrix();
                    // setViewport parameters:
                    //  lower_left_x, lower_left_y, viewport_width, viewport_height

                    renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
                    renderer.clear();
                    // left side
                    renderer.setViewport(1, 1, SCREEN_WIDTH - 2, SCREEN_HEIGHT - 2);
                    renderer.render(scene, camera);
                }


                function switchBattery() {
                    console.log(batterySupport.position);
                    setupTweenBatteryOut();
                    setupTweenBatteryIn();
                    tweenBatteryUp.start();
                    setTimeout(function () {
                        var newChargerMaterial = new THREE.MeshPhongMaterial({color: 0xFF6677, shininess: 30, specular: 0x990000, metal: true, side: THREE.DoubleSide});
                        console.log(batterySupport);
                        batterySupport.children[0].children[0].material = newChargerMaterial;
                    }, 2400);
                    setTimeout(function () {
                        tweenBatteryOut.stop();
                        tweenBatteryIn.start();
                    }, 3000);
                    setTimeout(function () {
                        tweenBatteryIn.stop();
                    }, 4700);
                    setTimeout(function () {
//                        alert("Click sound");
                    }, 5200);
                }

                function removeFilter() {

                    setupTweenFilterRotate();
                    setupTweenFilterGoUp();
                    setupTweenFilterGoOut();
                }


                function disrupter() {
                    console.log(scene);
                    var grupbaterie = scene.getObjectByName("grupBaterie");
                    grupbaterie.position.z += 5;
                }


                var manager = new THREE.LoadingManager();
                manager.onProgress = function (item, loaded, total) {
                    console.log(item, loaded, total);
                }


                var onProgress = function (xhr) {
                    console.log(object);
                    if (xhr.lengthComputable) {
                        var percentComplete = xhr.loaded / xhr.total * 100;
                        console.log(Math.round(percentComplete, 2) + '% downloaded');
                    }
                }

                var onError = function (xhr) {

                };
                var texture = new THREE.Texture();
                function load3DOBJmodels() {


                    var objLoader = new THREE.OBJLoader(manager);


                    objLoader.load('js/daes/OBJ/shell mecanism tigara.obj', function (object) {
                        object.traverse(function (child) {
                            if (child instanceof THREE.Mesh) {
                                child.material.map = texture;
                            }
                        });
//                        object.position.y = -30;
                        object.name = 'shellMecanismTigara';
                        scene.add(object);
                    }, onProgress, onError);
                    
                    objLoader.load('js/daes/OBJ/capac baterie.obj', function (object) {
                        object.traverse(function (child) {
                            if (child instanceof THREE.Mesh) {
                                child.material.map = texture;
                            }
                        });
//                        object.position.y = -30;
                        object.name = 'shellMecanismTigara2';
                        scene.add(object);
                    }, onProgress, onError);
                    objLoader.load('js/daes/OBJ/sipca 1.obj', function (object) {
                        object.traverse(function (child) {
                            if (child instanceof THREE.Mesh) {
                                child.material.map = texture;
                            }
                        });
//                        object.position.y = -30;
                        object.name = 'sipca1';
                        scene.add(object);
                    }, onProgress, onError);
                    objLoader.load('js/daes/OBJ/sipca 3.obj', function (object) {
                        object.traverse(function (child) {
                            if (child instanceof THREE.Mesh) {
                                child.material.map = texture;
                            }
                        });
//                        object.position.y = -30;
                        object.name = 'sipca3';
                        scene.add(object);
                    }, onProgress, onError);

                }

//                function test() {
//                    console.log(scene);
//
//                    var bla = new THREE.MeshPhongMaterial(disruptorMaterials.silver_material);
//                    asd = scene.getObjectByName('shellMecanismTigara');
//                    asd2 = scene.getObjectByName('sipca1');
//                    asd3 = scene.getObjectByName('sipca3');
//                    asd.children[0].material = bla;
//                    asd2.children[0].material = bla;
//                    asd3.children[0].material = bla;
//
//                }

                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///                    LOAD THE 3D MODELS                   ///
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////

                function load3Dmodels() {


                    var objectScale = 2;
                    var colladaLoader = new THREE.ColladaLoader();
                    colladaLoader.load('js/daes/MecanismTigara.dae', function colladaReady(collada) {
                        disruptor = collada.scene;
                        disruptorSkin = collada.skins[0];
                        disruptor.name = "disruptor";
                        group.add(disruptor);
                        disruptor.position.x = 0.1;
//                        disruptor.scale.x = 0.2;
//                        disruptor.scale.y = 0.2;
//                        disruptor.scale.z = 0.2;
//                        sipca.scale.y = 0.1;
//                        sipca.scale.z = 0.1;
                        var defaultMechanismMaterial = new THREE.MeshPhongMaterial(defaultMaterials.defaultMechanism);
                        disruptor.children[2].children[0].material = defaultMechanismMaterial;
                    });
                    colladaLoader.load('js/daes/Baterie.dae', function colladaReady(collada) {
                        battery = collada.scene;
                        battery.name = "battery";
                        batterySkin = collada.skins[0];
                        grupBaterie.add(battery);
                        battery.position.z = 4;
                        battery.position.x = 3.5;
                    });
                    colladaLoader.load('js/daes/CapacBaterie.dae', function colladaReady(collada) {
                        batterySupport = collada.scene;
                        batterySupport.name = "batterySupport";
                        batterySupportSkin = collada.skins[0];
                        grupBaterie.add(batterySupport);
//                        var defaultBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 50, specular: 0x222299, metal: true, side: THREE.DoubleSide});
//                        var pinkBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide});
                        var defaultBatterySupportMaterial = new THREE.MeshPhongMaterial(defaultMaterials.defaultBatterySupport);
                        batterySupport.children[0].children[0].material = defaultBatterySupportMaterial;
                        batterySupport.position.x = 5;
                        batterySupport.position.z = 0.3;
                    });
                    colladaLoader.load('js/daes/Sipca.dae', function colladaReady(collada) {
                        sipca = collada.scene;
                        sipca.name = "filter";
                        sipcaSkin = collada.skins[0];
                        grupFiltru.add(sipca);
                        sipca.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/Sticla.dae', function colladaReady(collada) {
                        sticla = collada.scene;
                        sticla.name = "filterGlass";
                        sticlaSkin = collada.skins[0];
                        grupFiltru.add(sticla);
                        sticla.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/RamaEcran.dae', function colladaReady(collada) {
                        ecran = collada.scene;
                        ecran.name = "screen";
                        ecranSkin = collada.skins[0];
                        group.add(ecran);
                        ecran.scale.x = 1.05;
                        ecran.scale.y = 1.05;
                        ecran.scale.z = 1.05;
                        ecran.position.z = 4.5;
                        ecran.position.y = -0.15;
                        ecran.position.x = -4.75;
                    });
                    colladaLoader.load('js/daes/ButonMare.dae', function colladaReady(collada) {
                        startButton = collada.scene;
                        startButtonSkin = collada.skins[0];
                        startButton.name = "startButton";
                        group.add(startButton);
                        startButton.position.z = -4.05;
                        startButton.position.y = -0.05;
                        startButton.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/ButonMic1.dae', function colladaReady(collada) {
                        buttonSmall1 = collada.scene;
                        buttonSmall1.name = "smallButton1";
                        buttonSmall1Skin = collada.skins[0];
                        group.add(buttonSmall1);
                        buttonSmall1.position.z = -4.05;
                        buttonSmall1.position.y = -0.05;
                        buttonSmall1.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/ButonMic2.dae', function colladaReady(collada) {
                        buttonSmall2 = collada.scene;
                        buttonSmall2.name = "smallButton2";
                        buttonSmall2Skin = collada.skins[0];
                        group.add(buttonSmall2);
                        buttonSmall2.position.z = -4.05;
                        buttonSmall2.position.y = -0.05;
                        buttonSmall2.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/FiletMecanismBaterie.dae', function colladaReady(collada) {
                        batteryThread = collada.scene;
                        batteryThread.name = "batteryThread";
                        batteryThreadSkin = collada.skins[0];
                        grupFiltru.add(batteryThread);
                        batteryThread.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/Logo.dae', function colladaReady(collada) {
                        logo = collada.scene;
                        logo.name = "logo";
                        logoSkin = collada.skins[0];
                        grupBaterie.add(logo);
                        logo.position.x = 3;
                        logo.position.z = -4;
                        logo.position.y = -0.2;
                    });
                    grupFiltru.position.z = -28;
                    group.position.z = -20;
                    grupBaterie.position.z = -20;
                    grupFiltru.scale.x = 2;
                    grupFiltru.scale.y = 2;
                    grupFiltru.scale.z = 2;
                    group.scale.x = 2;
                    group.scale.y = 2;
                    group.scale.z = 2;
                    grupBaterie.scale.x = 2;
                    grupBaterie.scale.y = 2;
                    grupBaterie.scale.z = 2;
                    //Actually create the screen
                    //lcdScreen
                    var lcdScreenGeometry = new THREE.PlaneGeometry(7.5, 2.5, 32, 32);
                    var lcdScreenMaterial = new THREE.MeshPhongMaterial({color: 0x6B7285, side: THREE.DoubleSide});
                    var lcdScreen = new THREE.Mesh(lcdScreenGeometry, lcdScreenMaterial);
                    lcdScreen.rotation.y = Math.PI / 2;
                    lcdScreen.position.x = -5.1; // adancime
                    lcdScreen.position.z = 8.75; //Stanga dreapta
                    lcdScreen.position.y = -0.15; //inaltime
                    group.add(lcdScreen);

                }




                function basicColorize() {

                    var mecanism_tigara = scene.getObjectByName("mecanism_tigara");
                    var mecanism_tigara_mesh = mecanism_tigara.children[0];
                    var silverPolished = new THREE.MeshPhongMaterial({color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide});
                    mecanism_tigara_mesh.material = silverPolished;
                    var grupu = scene.getObjectByName("grupPrincipal");
                    var grupuchildren = grupu.children;
                    var filter_material = new THREE.MeshPhongMaterial({color: 0xCCCCCC, shininess: 50, specular: 0xAACCDD, metal: true, side: THREE.DoubleSide});
                    var filter_mesh = scene.getObjectByName("Cylinder001").children[0];
                    filter_mesh.material = filter_material;
                    var white_glass_material = new THREE.MeshPhongMaterial({color: 0x777777, shininess: 10, specular: 0xDDDDDD, transparent: true, opacity: 0.5, side: THREE.DoubleSide});
                    var default_blueGlassMat = new THREE.MeshPhongMaterial({color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
                    var filter_glass_mesh = scene.getObjectByName("sticla001").children[0];
                    filter_glass_mesh.material = default_blueGlassMat;
                    var buttonsMaterial = new THREE.MeshPhongMaterial({color: 0xDDDDFF, shininess: 30, specular: 0xEEEEEE, metal: true, side: THREE.DoubleSide});
                    var bigButton_mesh = scene.getObjectByName("buton_mare").children[0];
                    bigButton_mesh.material = buttonsMaterial;
                    var smallButton1_mesh = scene.getObjectByName("buton_mic_1").children[0];
                    var smallButton2_mesh = scene.getObjectByName("buton_mic_2").children[0];
                    smallButton1_mesh.material = buttonsMaterial;
                    smallButton2_mesh.material = buttonsMaterial;
                    var rama_ecranMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 10, specular: 0xFFFFCC, side: THREE.DoubleSide});
                    var rama_ecran_mesh = scene.getObjectByName("rama_ecran").children[0];
                    rama_ecran_mesh.material = rama_ecranMaterial;
                }


                function displayDisruptorColourOptions() {

                    if (disruptor_colours_shown === false) {
                        console.log("SHOULD DISPLAY 3 COLOURS TO CHOOSE FROM FOR THE DISRUPTOR");
                        var boxGeometry = new THREE.BoxGeometry(25, 25, 25, 25);
//                        var goldenMaterial = new THREE.MeshPhongMaterial({color: disruptorColours.gold, specular: disruptorColours.gold_specular});
//                        var silverMaterial = new THREE.MeshPhongMaterial({color: disruptorColours.silver, specular: disruptorColours.silver_specular});
//                        var blackMaterial = new THREE.MeshPhongMaterial({color: 0x222222, specular: disruptorColours.black_specular});
                        var goldenMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.golden_material);
                        var silverMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.silver_material);
                        var blackMaterial = new THREE.MeshPhongMaterial(disruptorMaterials.black_material);
                        var box1 = new THREE.Mesh(boxGeometry, goldenMaterial);
                        box1.name = "GoldenBox";
                        var box2 = new THREE.Mesh(boxGeometry, silverMaterial);
                        box2.name = "SilverBox";
                        var box3 = new THREE.Mesh(boxGeometry, blackMaterial);
                        box3.name = "BlackBox";
                        threeColourBoxes = new THREE.Group();
                        threeColourBoxes.name = "threeColourBoxes";
                        threeColourBoxes.add(box1);
                        threeColourBoxes.add(box2);
                        threeColourBoxes.add(box3);
                        if (battery_colours_shown) {
                            removeBatteryColourOptions();
                        }

                        scene.add(threeColourBoxes);
                        disruptor_colours_shown = true;
                    } else {
                        console.log("The 3 colour boxes already are on the screen.");
                    }
                }

                function removeDisruptorColourOptions() {

                    if (disruptor_colours_shown) {
                        console.log(scene);
                        threeColourBoxes = scene.getObjectByName("threeColourBoxes");
                        scene.remove(threeColourBoxes);
                        disruptor_colours_shown = false;
                    } else {
                        console.log("Cannot remove threeColourBoxes if they dont exist");
                    }
                }


                function displayBatteryColourOptions() {
                    if (battery_colours_shown === false) {
                        var boxGeometry = new THREE.BoxGeometry(16, 16, 16, 16);
//                        var mat1 = new THREE.MeshPhongMaterial({color: batteryColours.red});
//                        var mat2 = new THREE.MeshPhongMaterial({color: batteryColours.green});
//                        var mat3 = new THREE.MeshPhongMaterial({color: batteryColours.purple});
//                        var mat4 = new THREE.MeshPhongMaterial({color: batteryColours.blue});
//                        var mat5 = new THREE.MeshPhongMaterial({color: batteryColours.pink});
//                        var mat6 = new THREE.MeshPhongMaterial({color: batteryColours.black});
//                        var mat7 = new THREE.MeshPhongMaterial({color: batteryColours.whiteblue});
                        var mat1 = new THREE.MeshPhongMaterial(batteryMaterials.red_battery);
                        var mat2 = new THREE.MeshPhongMaterial(batteryMaterials.green_battery);
                        var mat3 = new THREE.MeshPhongMaterial(batteryMaterials.purple_battery);
                        var mat4 = new THREE.MeshPhongMaterial(batteryMaterials.blue_battery);
                        var mat5 = new THREE.MeshPhongMaterial(batteryMaterials.pink_battery);
                        var mat6 = new THREE.MeshPhongMaterial(batteryMaterials.black_battery);
                        var mat7 = new THREE.MeshPhongMaterial(batteryMaterials.whiteblue_battery);
                        var box1 = new THREE.Mesh(boxGeometry, mat1);
                        box1.name = "batteryColour_box1";
                        var box2 = new THREE.Mesh(boxGeometry, mat2);
                        box2.name = "batteryColour_box2";
                        var box3 = new THREE.Mesh(boxGeometry, mat3);
                        box3.name = "batteryColour_box3";
                        var box4 = new THREE.Mesh(boxGeometry, mat4);
                        box4.name = "batteryColour_box4";
                        var box5 = new THREE.Mesh(boxGeometry, mat5);
                        box5.name = "batteryColour_box5";
                        var box6 = new THREE.Mesh(boxGeometry, mat6);
                        box6.name = "batteryColour_box6";
                        var box7 = new THREE.Mesh(boxGeometry, mat7);
                        box7.name = "batteryColour_box7";
                        sevenColourBoxes = new THREE.Group();
                        sevenColourBoxes.name = "sevenColourBoxes";
                        sevenColourBoxes.add(box1);
                        sevenColourBoxes.add(box2);
                        sevenColourBoxes.add(box3);
                        sevenColourBoxes.add(box4);
                        sevenColourBoxes.add(box5);
                        sevenColourBoxes.add(box6);
                        sevenColourBoxes.add(box7);
                        scene.add(sevenColourBoxes);
                        if (disruptor_colours_shown) {
                            removeDisruptorColourOptions();
                        }
                        battery_colours_shown = true;
                    } else {
                        console.log("The 7 colour boxes already are on the screen.");
                    }
                }


                function removeBatteryColourOptions() {

                    if (battery_colours_shown) {
                        sevenColourBoxes = scene.getObjectByName("sevenColourBoxes");
                        scene.remove(sevenColourBoxes);
                        battery_colours_shown = false;
                    } else {
                        console.log("Cannot remove sevenColourBoxes if they dont exist");
                    }


                }

                function changeMecanismColor(color) {
                    console.log("attempting to change mechanism color to " + color);
                    var mecanism_tigara_mesh = scene.getObjectByName("mecanism_tigara").children[0];
                    switch (color) {
                        case "black":
                            var blackBatteryMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = blackBatteryMaterial;
                            break;
                        case "gold":
                            var goldPolished = new THREE.MeshPhongMaterial({color: 0xEAE0D7, shininess: 50, specular: 0xEAE0D7, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = goldPolished;
                            break;
                        case "silver":
                            var silverPolished = new THREE.MeshPhongMaterial({color: 0xE4E4EE, shininess: 50, specular: 0xE4E4EE, metal: true, side: THREE.DoubleSide});
                            mecanism_tigara_mesh.material = silverPolished;
                            break;
                        default:
                            console.log("The colors you must chose are : black, gold or silver");
                            break;
                    }
                }


                function changeBatteryColor(color) {
                    console.log("attempting to change batery cover color to " + color);
                    var batterySupport_mesh = batterySupport.children[0].children[0];
                    var filter_glass_mesh = scene.getObjectByName("sticla001").children[0];
                    switch (color) {
                        case "black":
                            var blackBatteryMaterial = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 50, specular: 0x040404, metal: true, side: THREE.DoubleSide});
                            var blackGlassMat = new THREE.MeshPhongMaterial({color: 0x010101, shininess: 10, specular: 0x030303, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
                            batterySupport_mesh.material = blackBatteryMaterial;
                            filter_glass_mesh.material = blackGlassMat;
                            break;
                        case "blue":
                            var blueBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0x009EFA, shininess: 50, specular: 0x009EFA, metal: true, side: THREE.DoubleSide});
                            var blueGlassMat = new THREE.MeshPhongMaterial({color: 0x007777, shininess: 10, specular: 0x006ECA, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
                            batterySupport_mesh.material = blueBatterySupportMaterial;
                            filter_glass_mesh.material = blueGlassMat;
                            break;
                        case "pink":
                            var pinkBatterySupportMaterial = new THREE.MeshPhongMaterial({color: 0xFA55BB, shininess: 50, specular: 0xFA55BB, metal: true, side: THREE.DoubleSide});
                            var pinkGlassMat = new THREE.MeshPhongMaterial({color: 0xFA55BB, shininess: 10, specular: 0xFA55BB, transparent: true, opacity: 0.6, side: THREE.DoubleSide});
                            batterySupport_mesh.material = pinkBatterySupportMaterial;
                            filter_glass_mesh.material = pinkGlassMat;
                            break;
                        default:
                            console.log("The colors you must chose are : black, blue or pink");
                            break;
                    }
                }

                function playButonMareAction() {

                    if (startButtonCounter % 6 == 0) {
                        console.log(scene);
                        grupParticule = scene.getObjectByProperty('type', 'PointCloud');
                        console.log(grupParticule);
                        emitter = null;
                        particleGroup = null;
                        scene.remove(grupParticule);
                    } else if (startButtonCounter % 3 == 0) {
                        initParticles();
                    }

                }


                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////
                ///                        TWEENS                           ///
                ///////////////////////////////////////////////////////////////
                ///////////////////////////////////////////////////////////////

                function setupTweenBatteryOut()
                {
                    batteryGroup = scene.getObjectByName("grupBaterie");
                    var update = function () {
                        batteryGroup.position.y = current.y;
                        batteryGroup.position.x = current.x;
                        batteryGroup.position.z = current.z;
                    }
                    console.log("Battery Current Position");
                    console.log(batteryGroup.position);
                    var current = {x: 0, y: 0, z: -20};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    var easing2 = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    // build the tween lift the battery from the support
                    tweenBatteryUp = new TWEEN.Tween(current)
                            .to({z: +userOpts.liftoff}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing2)
                            .onUpdate(update);
                    tweenBatteryOut = new TWEEN.Tween(current)
                            .to({x: +userOpts.range}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(easing2)
                            .onUpdate(update);
                    tweenBatteryUp.chain(tweenBatteryOut);
                    // start the first
                }

                function setupTweenBatteryIn()
                {
                    var complete = function () {
                        console.log("BATTERY ATTACHED. PLAYING A CLICK SOUND !");
                        setTimeout(function () {
//                            alert("PLAYING CLICK SOUND NOW");
                        }, 300);
                    }

                    var update = function () {
                        batteryGroup.position.x = current.x;
                        batteryGroup.position.y = current.y;
                        batteryGroup.position.z = current.z;
                    }
                    var current = {x: 2000, y: userOpts.liftoff, z: -20};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: 0, y: 0, z: 0}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: 0, y: 0, z: -20}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update)
                            .onComplete(complete);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);
                }

                function setupTweenFilterRotate()
                {
                    var update = function () {
                        filtruTigara.rotation.y = current.rotY;
                        filtruTigara.position.x = current.x;
                        filtruTigara.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff, rotY: 0};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
//                    tweenFilterRotate = new TWEEN.Tween(current)
//                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(quintic)
//                            .onUpdate(update);
                    // build the tween to go backward
//                    tweenBatteryDown = new TWEEN.Tween(current)
//                            .to({x: 15, y: 0}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
//                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }

                function setupTweenFilterGoUp()
                {
                    // 
                    var update = function () {
                        chargerCube.position.x = current.x;
                        chargerCube.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: 15, y: 0}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update);
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }

                function setupTweenFilterGoOut()
                {
                    // 
                    var update = function () {
                        chargerCube.position.x = current.x;
                        chargerCube.position.y = current.y;
                    }
                    var current = {x: 2000, y: userOpts.liftoff};
                    // remove previous tweens if needed
                    TWEEN.removeAll();
                    // convert the string from dat-gui into tween.js functions 
                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
//                    console.log(easing);
                    // build the tween to go ahead
                    tweenBatteryIn = new TWEEN.Tween(current)
                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
                            .delay(userOpts.delay)
                            .easing(quintic)
                            .onUpdate(update);
                    // build the tween to go backward
                    tweenBatteryDown = new TWEEN.Tween(current)
                            .to({x: 15, y: 0}, userOpts.duration / 2)
                            .delay(userOpts.delay)
                            .easing(easing)
                            .onUpdate(update);
                    colladaLoader
//                    var tweenBack = new TWEEN.Tween(current)
//                            .to({x: -userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
                    tweenBatteryIn.chain(tweenBatteryDown);
                    // after tweenHead do tweenBack
//                    tweenHead.chain(tweenBack);
                    // after tweenBack do tweenHead, so it is cycling
//                    tweenBack.chain(tweenHead);

                    // start the first
//                    tweenHead.start();
                }






        </script>
    </body>
</html>
