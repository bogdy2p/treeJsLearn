<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - InnoKin Sketch</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                color: #cccccc;
                font-family:Monospace;
                font-size:13px;
                text-align:center;

                background-color: #000000;
                margin: 0px;
                overflow: hidden;
            }

            #info {
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
            }

            a {

                color: #0080ff;
            }

            #leftcontrols {
                position: absolute;
                bottom: 0px; width: 100%;
                height: 30px;
                padding: 5px;
                background-color: #FF66FF;
                /*z-index: 1000;*/
            }
            #container{
                position: absolute; left:0px; top:0px;
            }
        </style>
    </head>
    <body>

        <div id="container"></div>
        <div id="info">
            <a href="http://threejs.org" target="_blank">three.js</a> webgl - Innoking sketch  - by <a href="https://twitter.com/fernandojsg">ThePBC</a>
        </div>
        <div id ="leftcontrols">

            <button id="btn1" onclick="removeBattery();">Button1-RemoveBattery</button>

            <button id="btn2" onclick="test();">TEST</button>
            <button id="btn3" onclick="butonmic1();">Button mic 1</button>
            <button id="btn4" onclick="displayDisruptorOptions();">DisplayDisruptorOptions</button>
            <button id="btn5" onclick="sticlaAction();">STICLA</button>
            <button id="btn6" onclick="disrupter();">DISRUPTOR</button>





            aAAAAAAAAAAAAAAAAAAAAAA
        </div>
        <div id ="rightcontrols"></div>


        <!--<script src="js/libs/dat.gui.min.js"></script>-->
        <script src="js/three.min.js"></script>
        <script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/libs/stats.min.js"></script>
        <script src ="js/ColladaLoader.js"></script>
        <script src="js/Tween.js"></script>
        <script src="dat-gui/build/DAT.GUI.js"></script>

        <script>

                var group, grupFiltru, grupBaterie, group2, group3;


                var disruptor;
                var battery;
                var container, stats, mapCanvas;
                var controls, controls2;
                var particlesData = [];
                var camera, cameraHUD, mapCamera, scene, renderer, raycaster;
                var positions, colors;
                var pointCloud;
                var particlePositions;
                var linesMesh;
                var mouseX = 0, mouseY = 0;
                var mouseXOnMouseDown = 0;
                var SCREEN_WIDTH, SCREEN_HEIGHT;
                var targetRotation = 0;
                var actuatorCylinder, minusButtonCylinder, plusButtonCylinder, filtruTigara, chargerCube, disrupterCube;
                var targetRotationOnMouseDown = 0;
                var windowHalfX = window.innerWidth / 2;
                var windowHalfY = window.innerHeight / 2;
                var pointLight;


                var chargerMaterial;

//                var duration1 = 1000; //miliseconds
//                var duration2 = 2000; //miliseconds
//                var duration3 = 3000; //miliseconds
//                var duration4 = 4000; //miliseconds
//                var duration5 = 5000; //miliseconds
//                var currentTime;
//                var timeSpent = 0;        <div id="mapCanvas" style="position: absolute; right:5px; top:5px; width:320px; height:240px;"></div>

                var tweenBatteryOut, tweenBatteryIn, tweenBatteryUp, tweenBatteryDown;
                var startTime = Date.now();


                var userOpts = {
                    liftoff: 20,
                    range: 2000,
                    duration: 1500,
                    delay: 0,
                    easing: 'Exponential.EaseIn',
                    quintic_in: 'Quintic.EaseOut',
                }


                document.addEventListener('mousemove', onDocumentMouseMove, false);
                init();
                animate();

//                function setupTweenBatteryOut()
//                {
//                    // 
//                    var update = function () {
//                        chargerCube.position.y = current.y;
//                        chargerCube.position.x = current.x;
//                    }
//                    var current = {x: 15, y: 0};
//
//                    // remove previous tweens if needed
//                    TWEEN.removeAll();
//
//                    // convert the string from dat-gui into tween.js functions 
//                    var easing2 = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
//                    console.log(easing2);
////                    console.log(easing);
////                    
////                    
////                    
//                    // build the tween lift the battery from the support
//
//                    tweenBatteryUp = new TWEEN.Tween(current)
//                            .to({y: +userOpts.liftoff}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing2)
//                            .onUpdate(update);
//
//
//
//                    tweenBatteryOut = new TWEEN.Tween(current)
//                            .to({x: +userOpts.range}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(easing2)
//                            .onUpdate(update);
//
//                    tweenBatteryUp.chain(tweenBatteryOut);
//
//                    // start the first
////                    tweenHead.start();
//                }
//
//                function setupTweenBatteryIn()
//                {
//                    // 
//                    var complete = function () {
//                        console.log("BATTERY ATTACHED. PLAYING A CLICK SOUND !");
//                        setTimeout(function () {
//                            alert("PLAYING CLICK SOUND NOW");
//                        }, 300);
//
//                    }
//
//                    var update = function () {
//                        chargerCube.position.x = current.x;
//                        chargerCube.position.y = current.y;
//                    }
//                    var current = {x: 2000, y: userOpts.liftoff};
//
//                    // remove previous tweens if needed
//                    TWEEN.removeAll();
//
//                    // convert the string from dat-gui into tween.js functions 
//                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
//
//                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
////                    console.log(easing);
//                    // build the tween to go ahead
//                    tweenBatteryIn = new TWEEN.Tween(current)
//                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(quintic)
//                            .onUpdate(update);
//                    // build the tween to go backward
//                    tweenBatteryDown = new TWEEN.Tween(current)
//                            .to({x: 15, y: 0}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update)
//                            .onComplete(complete);
////                    var tweenBack = new TWEEN.Tween(current)
////                            .to({x: -userOpts.range}, userOpts.duration)
////                            .delay(userOpts.delay)
////                            .easing(easing)
////                            .onUpdate(update);
//                    tweenBatteryIn.chain(tweenBatteryDown);
//                    // after tweenHead do tweenBack
////                    tweenHead.chain(tweenBack);
//                    // after tweenBack do tweenHead, so it is cycling
////                    tweenBack.chain(tweenHead);
//
//                    // start the first
////                    tweenHead.start();
//                }
//
//                function setupTweenFilterRotate()
//                {
//                    // 
//                    var update = function () {
//                        filtruTigara.rotation.y = current.rotY;
//                        filtruTigara.position.x = current.x;
//                        filtruTigara.position.y = current.y;
//                    }
//                    var current = {x: 2000, y: userOpts.liftoff, rotY: 0};
//
//                    // remove previous tweens if needed
//                    TWEEN.removeAll();
//
//                    // convert the string from dat-gui into tween.js functions 
//                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
//
//                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
////                    console.log(easing);
//                    // build the tween to go ahead
////                    tweenFilterRotate = new TWEEN.Tween(current)
////                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
////                            .delay(userOpts.delay)
////                            .easing(quintic)
////                            .onUpdate(update);
//                    // build the tween to go backward
////                    tweenBatteryDown = new TWEEN.Tween(current)
////                            .to({x: 15, y: 0}, userOpts.duration / 2)
////                            .delay(userOpts.delay)
////                            .easing(easing)
////                            .onUpdate(update);
////                    var tweenBack = new TWEEN.Tween(current)
////                            .to({x: -userOpts.range}, userOpts.duration)
////                            .delay(userOpts.delay)
////                            .easing(easing)
////                            .onUpdate(update);
////                    tweenBatteryIn.chain(tweenBatteryDown);
//                    // after tweenHead do tweenBack
////                    tweenHead.chain(tweenBack);
//                    // after tweenBack do tweenHead, so it is cycling
////                    tweenBack.chain(tweenHead);
//
//                    // start the first
////                    tweenHead.start();
//                }
//
//                function setupTweenFilterGoUp()
//                {
//                    // 
//                    var update = function () {
//                        chargerCube.position.x = current.x;
//                        chargerCube.position.y = current.y;
//                    }
//                    var current = {x: 2000, y: userOpts.liftoff};
//
//                    // remove previous tweens if needed
//                    TWEEN.removeAll();
//
//                    // convert the string from dat-gui into tween.js functions 
//                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
//
//                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
////                    console.log(easing);
//                    // build the tween to go ahead
//                    tweenBatteryIn = new TWEEN.Tween(current)
//                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(quintic)
//                            .onUpdate(update);
//                    // build the tween to go backward
//                    tweenBatteryDown = new TWEEN.Tween(current)
//                            .to({x: 15, y: 0}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
////                    var tweenBack = new TWEEN.Tween(current)
////                            .to({x: -userOpts.range}, userOpts.duration)
////                            .delay(userOpts.delay)
////                            .easing(easing)
////                            .onUpdate(update);
//                    tweenBatteryIn.chain(tweenBatteryDown);
//                    // after tweenHead do tweenBack
////                    tweenHead.chain(tweenBack);
//                    // after tweenBack do tweenHead, so it is cycling
////                    tweenBack.chain(tweenHead);
//
//                    // start the first
////                    tweenHead.start();
//                }
//
//                function setupTweenFilterGoOut()
//                {
//                    // 
//                    var update = function () {
//                        chargerCube.position.x = current.x;
//                        chargerCube.position.y = current.y;
//                    }
//                    var current = {x: 2000, y: userOpts.liftoff};
//
//                    // remove previous tweens if needed
//                    TWEEN.removeAll();
//
//                    // convert the string from dat-gui into tween.js functions 
//                    var easing = TWEEN.Easing[userOpts.easing.split('.')[0]][userOpts.easing.split('.')[1]];
//
//                    var quintic = TWEEN.Easing[userOpts.quintic_in.split('.')[0]][userOpts.quintic_in.split('.')[1]];
////                    console.log(easing);
//                    // build the tween to go ahead
//                    tweenBatteryIn = new TWEEN.Tween(current)
//                            .to({x: 15, y: userOpts.liftoff}, userOpts.duration)
//                            .delay(userOpts.delay)
//                            .easing(quintic)
//                            .onUpdate(update);
//                    // build the tween to go backward
//                    tweenBatteryDown = new TWEEN.Tween(current)
//                            .to({x: 15, y: 0}, userOpts.duration / 2)
//                            .delay(userOpts.delay)
//                            .easing(easing)
//                            .onUpdate(update);
//                    colladaLoader
////                    var tweenBack = new TWEEN.Tween(current)
////                            .to({x: -userOpts.range}, userOpts.duration)
////                            .delay(userOpts.delay)
////                            .easing(easing)
////                            .onUpdate(update);
//                    tweenBatteryIn.chain(tweenBatteryDown);
//                    // after tweenHead do tweenBack
////                    tweenHead.chain(tweenBack);
//                    // after tweenBack do tweenHead, so it is cycling
////                    tweenBack.chain(tweenHead);
//
//                    // start the first
////                    tweenHead.start();
//                }

                function init() {
                    scene = new THREE.Scene();
                    container = document.getElementById('container');
//                    mapCanvas = document.getElementById('mapCanvas');

                    SCREEN_WIDTH = window.innerWidth;
                    SCREEN_HEIGHT = window.innerHeight;
                    var ASPECT_RATIO = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera = new THREE.PerspectiveCamera(45, ASPECT_RATIO, 1, 1000);
                    camera.position.x = 100;
                    camera.position.z = 100;
                    camera.position.y = 100;
                    scene.add(camera);

                    mapCamera = new THREE.PerspectiveCamera(45, ASPECT_RATIO, 1, 1000);
                    mapCamera.position.x = 100;
                    mapCamera.position.z = 0;
                    mapCamera.position.y = 100;
                    scene.add(mapCamera);



//                    console.log(mapCamera);


                    raycaster = new THREE.Raycaster();
                    // LIGHTS

                    controls = new THREE.OrbitControls(camera, container);
                    controls.noZoom = false;
                    controls.minDistance = 15;
                    controls.maxDistance = 200;
                    controls.noPan = true;

                    controls2 = new THREE.OrbitControls(mapCamera, container);
                    controls2.noPan = true;
                    controls2.noZoom = true;
//                    var dirLight = new THREE.DirectionalLight(0xffffff, 0.125);
//                    dirLight.position.set(0, 0, 1).normalize();
//                  scene.add(dirLight);

                    pointLight = new THREE.PointLight(0xffffff, 0.5);
                    pointLight.position.set(20, 20, 20);
                    scene.add(pointLight);
                    group = new THREE.Group();
                    scene.add(group);

                    // SKYBOX/FOG
                    var skyBoxGeometry = new THREE.BoxGeometry(10000, 10000, 10000);
                    var skyBoxMaterial = new THREE.MeshBasicMaterial({color: 0x9999ff, side: THREE.BackSide});
                    var skyBox = new THREE.Mesh(skyBoxGeometry, skyBoxMaterial);
                    scene.add(skyBox);


                    grupFiltru = new THREE.Group();
                    scene.add(grupFiltru);
                    grupBaterie = new THREE.Group();
                    scene.add(grupBaterie);

                    //load the 3d Model files
                    //////////////////////////////////////////////
                    load3Dmodels();
                    //////////////////////////////////////////////
                    // Add Charger 
                    //Grosime,Lungime,Latime
                    setTimeout(function () {
                        basicColorize();
                        console.log('basiccolorize');
                        displayDisruptorOptions();
                    }, 2800);

                    var axisHelper = new THREE.AxisHelper(255);
                    scene.add(axisHelper);


                    renderer = new THREE.WebGLRenderer({antialias: true});
                    renderer.setClearColor(0x444444, 1);
//                    renderer.setPixelRatio(window.devicePixelRatio);
//                    renderer.setSize(window.innerWidth, window.innerHeight);
//                    renderer.gammaInput = true;
//                    renderer.gammaOutput = true;
                    renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
                    container.appendChild(renderer.domElement);
//                    mapCanvas.appendChild(renderer.domElement);
//                    stats = new Stats();
//                    stats.domElement.style.position = 'absolute';
//                    stats.domElement.style.top = '0px';
//                    container.appendChild(stats.domElement);
                    renderer.domElement.addEventListener('mousedown', onDocumentMouseDown, false);
                    renderer.domElement.addEventListener('touchstart', onDocumentTouchStart, false);
                    renderer.domElement.addEventListener('touchmove', onDocumentTouchMove, false);
                    window.addEventListener('resize', onWindowResize, false);
                    renderer.autoClear = false;
                }

                function onWindowResize() {

                    windowHalfX = window.innerWidth / 2;
                    windowHalfY = window.innerHeight / 2;
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();

                    renderer.setSize(window.innerWidth, window.innerHeight);
                }

                function animate() {



                    requestAnimationFrame(animate);
                    render();
                    var redBox = scene.children[5];

                    if (redBox) {
//                        redBox.position.set(camera.position.x , camera.position.y - 50, camera.position.z );
//                        console.log(redBox.position);


                    }


//                    stats.update();
                    TWEEN.update();
                    update();

                }

                function onDocumentMouseDown(event) {
                    event.preventDefault();
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);

                    var mouseVector = new THREE.Vector3();
                    mouseVector.x = 2 * (event.clientX / SCREEN_WIDTH) - 1;
                    mouseVector.y = 1 - 2 * (event.clientY / SCREEN_HEIGHT);

                    raycaster.setFromCamera(mouseVector, camera);

                    var intersectedObjects = raycaster.intersectObjects(scene.children);

                    if (intersectedObjects.length > 0) {

                        var Object = intersectedObjects[0];

                        switch (Object.object.id) {

                            case 8:
                                console.log("That's the battery mate!");
                                break;
                            case 9:
                                console.log("You clicked the disruptor");
                                break;
                            case 10:
                                console.log("Lighter should START");
                                startButtonClick();

                                break;
                            case 11:
                                console.log("You pressed the +");
                                plusButtonClick();

                                break;
                            case 12:
                                console.log("You pressed the -");
                                minusButtonClick();
                                break;
                            case 13:
                                console.log("Why did you click the screen ?");
                                break;
                            case 14:
                                console.log("Why click the Filter ?");
                                break;
                            default:
                                console.log("nothing clicked");
                                break;
                        }

                    }


                }



                function onDocumentMouseMove(event) {

                    mouseX = event.clientX - windowHalfX;
                    targetRotationX = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.002;
                }

                function onDocumentMouseUp(event) {
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                    resetButtonPositions();


                }

                function onDocumentMouseOut(event) {
                    renderer.domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                    renderer.domElement.addEventListener('mouseup', onDocumentMouseUp, false);
                    renderer.domElement.addEventListener('mouseout', onDocumentMouseOut, false);
                }

                function onDocumentTouchStart(event) {
//                    alert("TOUCH DETECTED");
//                    alert(event);
                }

                function onDocumentTouchMove(event) {
//                    alert("TOUCH MOVEMENT DETECTED");
                }

                function startButtonClick() {

                    console.log("ENTERED STARTBUTTON CLICKED");
                    actuatorCylinder.position.x += 1;
                }

                function plusButtonClick() {
                    console.log("plusbuttonclick function");
                    plusButtonCylinder.position.x += 1;
                }

                function minusButtonClick() {
                    console.log("Minusbutton click function");
                    minusButtonCylinder.position.x += 1;
                }

                function resetButtonPositions() {

//                    actuatorCylinder.position.x = -7;
//                    minusButtonCylinder.position.x = -7;
//                    plusButtonCylinder.position.x = -7;

                }

                function render() {

////                    var time = Date.now() * 0.001;
//////                    camera.up = new THREE.Vector3(0,0,0);
////                    cameraGroup.lookAt(scene.position);
//////                    group.rotation.y = time * 0.1;
//////                    boxRed = scene.children[5];
//////                    if (boxRed) {
//////                        boxRed.position.x = camera.position.x;
//////                    }
////
////                    renderer.render(scene, camera);
////                    var newlightposition = camera.position;
////                    pointLight.position.set(camera.position.x, camera.position.y, camera.position.z);
////
//////                    console.log(camera);
//
//                    var w = window.innerWidth, h = window.innerHeight;
////
////                    // setViewport parameters:
////                    //  lower_left_x, lower_left_y, viewport_width, viewport_height
//                    renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
//                    camera.lookAt(scene.position);
//                    renderer.clear();
//
//
//
//                    // full display
////                     renderer.setViewport( 0, 0, SCREEN_WIDTH - 2, 0.5 * SCREEN_HEIGHT - 2 );
////                    camera.lookAt(scene.position);
//                    renderer.render(scene, camera);
//                    mapCamera.lookAt(scene.position);
//                    // minimap (overhead orthogonal camera)
//                    //  lower_left_x, lower_left_y, viewport_width, viewport_height
//                    renderer.setViewport(900, 000, 600, 600);
////                    renderer.render(scene, mapCamera);
////                    renderer.clear();


                    var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
                    camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
                    mapCamera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
                    camera.updateProjectionMatrix();
                    mapCamera.updateProjectionMatrix();

                    // setViewport parameters:
                    //  lower_left_x, lower_left_y, viewport_width, viewport_height

                    renderer.setViewport(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
                    renderer.clear();

                    // left side
                    renderer.setViewport(1, 1, SCREEN_WIDTH - 2, SCREEN_HEIGHT - 2);
                    renderer.render(scene, camera);

                    // right side
                    renderer.setViewport(0.80 * SCREEN_WIDTH + 1, 600, 0.20 * SCREEN_WIDTH - 2, SCREEN_HEIGHT / 4 - 2);
                    renderer.render(scene, mapCamera);


                }


                function removeBattery() {
                    setupTweenBatteryOut();
                    setupTweenBatteryIn();
                    tweenBatteryUp.start();
                    setTimeout(function () {
                        var newChargerMaterial = new THREE.MeshPhongMaterial({color: 0x666677, shininess: 10, specular: 0x990000, metal: true, side: 2});
                        chargerCube.material = newChargerMaterial;
                    }, 2400);
                    setTimeout(function () {
                        tweenBatteryOut.stop();
                        tweenBatteryIn.start();
                    }, 3000);
                    setTimeout(function () {
                        tweenBatteryIn.stop();
                    }, 4700);
                    setTimeout(function () {
//                        alert("Click sound");
                    }, 5200);
                }

                function removeFilter() {

                    setupTweenFilterRotate();
                    setupTweenFilterGoUp();
                    setupTweenFilterGoOut();

                }


                function test() {

//                    var linemat = new THREE.LineBasicMaterial({color: 0x0055FF});
//
//                    var geometry = new THREE.Geometry();
//                    geometry.vertices.push(camera.position);
//                    geometry.vertices.push(new THREE.Vector3(25, 25, 25));
////                    geometry.vertices.push(new THREE.Vector3(100, 0, 0));
////                    geometry.vertices.push(new THREE.Vector3(100, 50, 0));
////                    geometry.vertices.push(new THREE.Vector3(100, 0, 40));
//
//                    var line = new THREE.Line(geometry, linemat);
//
////                    cameraGroup.add(line);
//                    console.log(cameraGroup);
//                    console.log(line);
//
//
//
//                    var dx = camera.position.x - 25;
//                    var dy = camera.position.y - 25;
//                    var dz = camera.position.z - 25;
//
//                    var distanceToMiddle = Math.sqrt(dx * dx + dy * dy + dz * dz);
//
//                    console.log(distanceToMiddle);



                }

                function update()
                {
//                    var delta = clock.getDelta(); // seconds.
//                    var moveDistance = 200 * delta; // 200 pixels per second
//                    var rotateAngle = Math.PI / 2 * delta;   // pi/2 radians (90 degrees) per second

                    // local transformations

//                    // move forwards/backwards/left/right
//                    if (keyboard.pressed("W"))
//                        MovingCube.translateZ(-moveDistance);
//                    if (keyboard.pressed("S"))
//                        MovingCube.translateZ(moveDistance);
//                    if (keyboard.pressed("Q"))
//                        MovingCube.translateX(-moveDistance);
//                    if (keyboard.pressed("E"))
//                        MovingCube.translateX(moveDistance);
//
//                    // rotate left/right/up/down
//                    var rotation_matrix = new THREE.Matrix4().identity();
//                    if (keyboard.pressed("A"))
//                        MovingCube.rotateOnAxis(new THREE.Vector3(0, 1, 0), rotateAngle);
//                    if (keyboard.pressed("D"))
//                        MovingCube.rotateOnAxis(new THREE.Vector3(0, 1, 0), -rotateAngle);
//                    if (keyboard.pressed("R"))
//                        MovingCube.rotateOnAxis(new THREE.Vector3(1, 0, 0), rotateAngle);
//                    if (keyboard.pressed("F"))
//                        MovingCube.rotateOnAxis(new THREE.Vector3(1, 0, 0), -rotateAngle);
//
//                    if (keyboard.pressed("Z"))
//                    {
//                        MovingCube.position.set(0, 25.1, 0);
//                        MovingCube.rotation.set(0, 0, 0);
//                    }

                    var relativeCameraOffset = new THREE.Vector3(0, 50, 200 + 100);

//                    var cameraOffset = relativeCameraOffset.applyMatrix4(scene.matrixWorld);
//
//                    camera.position.x = cameraOffset.x;
//                    camera.position.y = cameraOffset.y;
//                    camera.position.z = cameraOffset.z;
//                    camera.lookAt(scene.position);

                    //stats.update();
                }




                function sticlaAction() {
                    var grupu = scene.children[1];
                    var grupuchildren = grupu.children;
                    for (i = 0; i < 5; i++) {
                        var lampa = grupuchildren[i].children[1];
                        lampa.position.x -= 0.1;
                        var pointlight = lampa.children[0];
                        pointlight.intensity = 0.2;
                    }
                }


                function disrupter() {


                    console.log(scene);
                    var grupbaterie = scene.children[3];
//                    grupbaterie.position.z += 5;


                }




                function load3Dmodels() {


                    var objectScale = 2;


                    var colladaLoader = new THREE.ColladaLoader();
                    //LOADING ORDER
                    //1. DISRUPTOR
                    //2. BATTERY
                    //3. BATTERYCASE
                    //4. SIPCA FILTRU
                    //5. STICLA FILTRU
                    //6. ECRAN 
                    //7. BUTON MARE
                    //8. BUTONMIC1
                    //9. BUTONMIC2
                    //10.FILET MECANISM BATERIE
                    //11.FILTE SIPCA
                    //12.LOGO EXTERN
                    colladaLoader.load('js/daes/MecanismTigara.dae', function colladaReady(collada) {
                        disruptor = collada.scene;
                        disruptorSkin = collada.skins[0];
                        group.add(disruptor);
                        disruptor.position.x = 0.1;
                    });
                    colladaLoader.load('js/daes/Baterie.dae', function colladaReady(collada) {
                        battery = collada.scene;
                        batterySkin = collada.skins[0];
                        grupBaterie.add(battery);
                        battery.position.z = 4;
                        battery.position.x = 3.5;
                    });
                    colladaLoader.load('js/daes/CapacBaterie.dae', function colladaReady(collada) {
                        batterySupport = collada.scene;
                        batterySupportSkin = collada.skins[0];
                        grupBaterie.add(batterySupport);
                        batterySupport.position.x = 5;
                        batterySupport.position.z = 0.3;
                    });
                    colladaLoader.load('js/daes/Sipca.dae', function colladaReady(collada) {
                        sipca = collada.scene;
                        sipcaSkin = collada.skins[0];
                        grupFiltru.add(sipca);
                        sipca.position.x = 1.5;

                    });
                    colladaLoader.load('js/daes/Sticla.dae', function colladaReady(collada) {
                        sticla = collada.scene;
                        sticlaSkin = collada.skins[0];
                        grupFiltru.add(sticla);
                        sticla.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/RamaEcran.dae', function colladaReady(collada) {
                        ecran = collada.scene;
                        ecranSkin = collada.skins[0];
                        group.add(ecran);
                        ecran.position.z = 4.5;
                        ecran.position.y = -0.15;
                        ecran.position.x = -5;
                    });
                    colladaLoader.load('js/daes/ButonMare.dae', function colladaReady(collada) {
                        bigButon = collada.scene;
                        bigButonSkin = collada.skins[0];

                        group.add(bigButon);
                        bigButon.position.z = -4.05;
                        bigButon.position.y = -0.05;
                        bigButon.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/ButonMic1.dae', function colladaReady(collada) {
                        buttonSmall1 = collada.scene;
                        buttonSmall1Skin = collada.skins[0];
                        group.add(buttonSmall1);
                        buttonSmall1.position.z = -4.05;
                        buttonSmall1.position.y = -0.05;
                        buttonSmall1.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/ButonMic2.dae', function colladaReady(collada) {
                        buttonSmall2 = collada.scene;
                        buttonSmall2Skin = collada.skins[0];
                        group.add(buttonSmall2);
                        buttonSmall2.position.z = -4.05;
                        buttonSmall2.position.y = -0.05;
                        buttonSmall2.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/FiletMecanismBaterie.dae', function colladaReady(collada) {
                        batteryThread = collada.scene;
                        batteryThreadSkin = collada.skins[0];
                        grupFiltru.add(batteryThread);
                        batteryThread.position.x = 1.5;
                    });
                    colladaLoader.load('js/daes/Logo.dae', function colladaReady(collada) {
                        logo = collada.scene;
                        logoSkin = collada.skins[0];
                        grupBaterie.add(logo);
                        logo.position.x = 3;
                        logo.position.z = -4;
                        logo.position.y = -0.2;
                    });

                    grupFiltru.position.z = -28;
                    group.position.z = -20;
                    grupBaterie.position.z = -20;
                    grupFiltru.scale.x = 2;
                    grupFiltru.scale.y = 2;
                    grupFiltru.scale.z = 2;
                    group.scale.x = 2;
                    group.scale.y = 2;
                    group.scale.z = 2;
                    grupBaterie.scale.x = 2;
                    grupBaterie.scale.y = 2;
                    grupBaterie.scale.z = 2;




                }




                function basicColorize() {
//                    for (i = 0; i < 9; i++) {
//                    var object = scene.children[1].children[i]; //.children[2];
//                        console.log(object);
//                    }
                    console.log(scene);
                    var mecanism_tigara = scene.children[2].children[4].children[2];
                    var mecanism_tigara_mesh = mecanism_tigara.children[0];
                    var testMaterial = new THREE.MeshPhongMaterial({color: 0xFF2222, shininess: 8, specular: 0x555555, metal: false});
                    mecanism_tigara_mesh.material = testMaterial;
                    var grupu = scene.children[2];
                    var grupuchildren = grupu.children;

                    for (i = 0; i < 5; i++) {
                        var lampa = grupuchildren[i].children[1];
//                        console.log(lampa);
                        lampa.visible = false;
                        lampa.position.x -= 0.1;
                        var pointlight = lampa.children[0];
                        pointlight.intensity = 1;
                        pointlight.visible = false;
                    }
//                    console.log(mecanism_tigara);




                    var filter_material = new THREE.MeshPhongMaterial({color: 0xFFFFFF, shininess: 30, specular: 0xDDDDDD, metal: true});
                    var filtru = scene.children[2].children[1].children[2].children[0];
//                    console.log(filtru);
                    filtru.material = filter_material;


                    var glass_material = new THREE.MeshPhongMaterial({color: 0x777777, shininess: 2, specular: 0xDDDDDD, transparent: true, opacity: 0.2});
                    var filter_glass = scene.children[2].children[0].children[2].children[0];
                    filter_glass.material = glass_material;

                    var buttonsMaterial = new THREE.MeshPhongMaterial({color: 0xDDDDFF, shininess: 30, specular: 0xEEEEEE, metal: true});
                    var bigButton = scene.children[2].children[1].children[2].children[0];
                    bigButton.material = buttonsMaterial;

                    var smallButton1 = scene.children[2].children[2].children[2].children[0];
                    var smallButton2 = scene.children[2].children[3].children[2].children[0];
//                    console.log(smallButton2);
                    smallButton1.material = buttonsMaterial;
                    smallButton2.material = buttonsMaterial;

                }


                function displayDisruptorOptions() {


                    console.log("DisruptorOptions");
                    var boxGeometry = new THREE.BoxGeometry(30, 30, 30, 30);
                    var redMaterial = new THREE.MeshPhongMaterial({color: 0xFF0000});
                    var greenMaterial = new THREE.MeshPhongMaterial({color: 0x00FF00});
                    var blueMaterial = new THREE.MeshPhongMaterial({color: 0x0000FF});
                    var boxRed = new THREE.Mesh(boxGeometry, redMaterial);
                    var boxGreen = new THREE.Mesh(boxGeometry, greenMaterial);
                    var boxBlue = new THREE.Mesh(boxGeometry, blueMaterial);

                    scene.add(boxRed);
//                    scene.add(boxGreen);
//                    scene.add(boxBlue);
                    boxRed.position.x = camera.position.x - 200;
                    boxRed.position.y = camera.position.y - 100;
                    boxRed.position.z = camera.position.z - 200;
//                    boxGreen.position.x = camera.position.x - 200;
//                    boxGreen.position.y = camera.position.y - 100;
//                    boxGreen.position.z = camera.position.z - 250;
//                    boxBlue.position.x = camera.position.x - 250;
//                    boxBlue.position.y = camera.position.y - 100;
//                    boxBlue.position.z = camera.position.z - 300;
//                    console.log(camera.position);
//                    console.log(box1);
//
//                    boxRed.position.x = camera.position.x - 220;
//                    boxRed.position.y = camera.position.y - 100;
//                    boxRed.position.z = camera.position.z - 300;

//                    console.log(scene);
//
//                    console.log(camera);
//
//
//                    console.log(boxRed);

                }










        </script>
    </body>
</html>
